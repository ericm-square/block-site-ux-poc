{"version":3,"names":["noop","baseFindIndex","array","predicate","fromIndex","fromRight","length","index","baseIsNaN","value","strictIndexOf","baseIndexOf","arrayIncludes","get","object","path","defaultValue","result","undefined","baseGet","COMPARE_PARTIAL_FLAG","COMPARE_UNORDERED_FLAG","baseIsMatch","source","matchData","customizer","noCustomizer","Object","data","key","objValue","srcValue","stack","Stack","baseIsEqual","isStrictComparable","isObject","getMatchData","keys","matchesStrictComparable","baseMatches","baseMatchesProperty","isKey","toKey","hasIn","baseProperty","basePropertyDeep","property","baseIteratee","identity","isArray","arrayIncludesWith","comparator","INFINITY","createSet","Set","setToArray","values","createSet$1","LARGE_ARRAY_SIZE","baseUniq","iteratee","includes","isCommon","seen","set","cacheHas","SetCache","outer","computed","seenIndex","push","uniqBy","marketListCss","MarketListStyle0","MarketList","this","observers","reorderableWatcher","setReorderable","valueWatcher","setSelectionsFromValue","hideSelectableCountWatcher","injectCountOnControlRow","rowSelectedEventHandler","e","handleItemSelectedEvent","target","rowDeselectedEventHandler","handleItemDeselectedEvent","cardSelectedEventHandler","cardDeselectedEventHandler","marketInputSearchValueChangeEventHander","detail","filterItems","getEventSelectionDetails","prevSelectionValues","split","filter","isValueEmpty","Array","currentSelections","selections","item","controlRow","currentSelectionValues","reduce","items","selectedItem","selectAllItems","selectItem","join","marketListSelectionsDidChange","emit","newSelection","newSelectionValue","newDeselection","newDeselectionValue","deselectedItem","has","shouldSelectAll","_b","_a","filteredItems","visible","nonDisabledItems","disabled","every","selected","deselectAllItems","deselectItem","interactive","multiselect","deselectItems","add","selectableItems","delete","selectedItems","forEach","deselect","visibleItemsSet","selectedItemsToKeep","syncListInteractiveWithItems","tagName","getNamespacedTagFor","toUpperCase","processItems","transient","cardRow","querySelector","setRowProperties","getCurrentSelectionValues","row","togglable","silentlySelect","silentlyDeselect","setSelectionsFromRowAttributes","initialSelections","setListAndItemsRoles","itemSelectableTypes","map","getItemSelectableType","allItemsHaveSameSelectableType","type","ListItemSelectableType","CHECKBOX","RADIO","SWITCH","SELECTABLE_WITHOUT_CONTROL","el","setAttribute","setInternalState","querySelectorAll","syncControlRowWithSelections","slottedControl","isCheckbox","toLowerCase","controlRowStatus","some","asyncRequestAnimationFrame","removeAttribute","countAccessoryEl","hideSelectableCount","removeChild","count","textContent","newEl","document","createElement","classList","appendChild","query","getAttribute","filterStrategy","callbackResult","label","_c","toLocaleLowerCase","call","isFound","_d","search","RegExp","_f","_e","labelEl","_g","_j","_h","String","hidden","visibleSelected","requestAnimationFrame","remove","lastVisibleItem","toggle","marketListItemsFiltered","prevItems","updateSelectedItemsInFilteredItems","handleSearchSlotchange","inputSearchEl","hasSearch","Boolean","defaultSlotchangeHandler","marketListSlotChange","controlRowSlotchangeHandler","slottedRow","isValidControl","setEmptyStateVisibility","emptyStateEl","shadowRoot","willShowEmptyState","initItemDisabledAttributeObserver","itemDisabledAttribute","MutationObserver","mutations","mutation","parentElement","attributeName","observe","attributes","attributeFilter","childList","subtree","connectedCallback","componentWillLoad","componentWillRender","componentDidLoad","disconnectedCallback","disconnect","handleKeydown","handleArrowDown","handleArrowUp","focused","prevFocusedRowIndex","indexOf","i","focus","preventDefault","focusRowAtIndex","Promise","resolve","reject","Error","reorderable","reorderMode","reorder","marketListItemsReordered","destroy","Reorderable","accepts","event","mode","isDraggable","dragEnabled","onDragMove","dragMove","onDragLeave","dragLeave","onDragEnd","dragEnd","onDragDrop","dragDrop","componentDidRender","render","MarketEmptyState","h","Host","class","name","onKeydown","onMarketDragMove","onMarketDragLeave","onMarketDragEnd","onMarketDragDrop","onSlotchange","height","slot","viewBox","width","xmlns","d","fill"],"sources":["../../node_modules/lodash-es/noop.js","../../node_modules/lodash-es/_baseFindIndex.js","../../node_modules/lodash-es/_baseIsNaN.js","../../node_modules/lodash-es/_strictIndexOf.js","../../node_modules/lodash-es/_baseIndexOf.js","../../node_modules/lodash-es/_arrayIncludes.js","../../node_modules/lodash-es/get.js","../../node_modules/lodash-es/_baseIsMatch.js","../../node_modules/lodash-es/_isStrictComparable.js","../../node_modules/lodash-es/_getMatchData.js","../../node_modules/lodash-es/_matchesStrictComparable.js","../../node_modules/lodash-es/_baseMatches.js","../../node_modules/lodash-es/_baseMatchesProperty.js","../../node_modules/lodash-es/_baseProperty.js","../../node_modules/lodash-es/_basePropertyDeep.js","../../node_modules/lodash-es/property.js","../../node_modules/lodash-es/_baseIteratee.js","../../node_modules/lodash-es/_arrayIncludesWith.js","../../node_modules/lodash-es/_createSet.js","../../node_modules/lodash-es/_baseUniq.js","../../node_modules/lodash-es/uniqBy.js","src/components/market-list/market-list.css?tag=market-list&encapsulation=shadow","src/components/market-list/market-list.tsx"],"sourcesContent":["/**\n * This method returns `undefined`.\n *\n * @static\n * @memberOf _\n * @since 2.3.0\n * @category Util\n * @example\n *\n * _.times(2, _.noop);\n * // => [undefined, undefined]\n */\nfunction noop() {\n  // No operation performed.\n}\n\nexport default noop;\n","/**\n * The base implementation of `_.findIndex` and `_.findLastIndex` without\n * support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} predicate The function invoked per iteration.\n * @param {number} fromIndex The index to search from.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseFindIndex(array, predicate, fromIndex, fromRight) {\n  var length = array.length,\n      index = fromIndex + (fromRight ? 1 : -1);\n\n  while ((fromRight ? index-- : ++index < length)) {\n    if (predicate(array[index], index, array)) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nexport default baseFindIndex;\n","/**\n * The base implementation of `_.isNaN` without support for number objects.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n */\nfunction baseIsNaN(value) {\n  return value !== value;\n}\n\nexport default baseIsNaN;\n","/**\n * A specialized version of `_.indexOf` which performs strict equality\n * comparisons of values, i.e. `===`.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction strictIndexOf(array, value, fromIndex) {\n  var index = fromIndex - 1,\n      length = array.length;\n\n  while (++index < length) {\n    if (array[index] === value) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nexport default strictIndexOf;\n","import baseFindIndex from './_baseFindIndex.js';\nimport baseIsNaN from './_baseIsNaN.js';\nimport strictIndexOf from './_strictIndexOf.js';\n\n/**\n * The base implementation of `_.indexOf` without `fromIndex` bounds checks.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseIndexOf(array, value, fromIndex) {\n  return value === value\n    ? strictIndexOf(array, value, fromIndex)\n    : baseFindIndex(array, baseIsNaN, fromIndex);\n}\n\nexport default baseIndexOf;\n","import baseIndexOf from './_baseIndexOf.js';\n\n/**\n * A specialized version of `_.includes` for arrays without support for\n * specifying an index to search from.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludes(array, value) {\n  var length = array == null ? 0 : array.length;\n  return !!length && baseIndexOf(array, value, 0) > -1;\n}\n\nexport default arrayIncludes;\n","import baseGet from './_baseGet.js';\n\n/**\n * Gets the value at `path` of `object`. If the resolved value is\n * `undefined`, the `defaultValue` is returned in its place.\n *\n * @static\n * @memberOf _\n * @since 3.7.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n * @returns {*} Returns the resolved value.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n *\n * _.get(object, 'a[0].b.c');\n * // => 3\n *\n * _.get(object, ['a', '0', 'b', 'c']);\n * // => 3\n *\n * _.get(object, 'a.b.c', 'default');\n * // => 'default'\n */\nfunction get(object, path, defaultValue) {\n  var result = object == null ? undefined : baseGet(object, path);\n  return result === undefined ? defaultValue : result;\n}\n\nexport default get;\n","import Stack from './_Stack.js';\nimport baseIsEqual from './_baseIsEqual.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.isMatch` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to inspect.\n * @param {Object} source The object of property values to match.\n * @param {Array} matchData The property names, values, and compare flags to match.\n * @param {Function} [customizer] The function to customize comparisons.\n * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n */\nfunction baseIsMatch(object, source, matchData, customizer) {\n  var index = matchData.length,\n      length = index,\n      noCustomizer = !customizer;\n\n  if (object == null) {\n    return !length;\n  }\n  object = Object(object);\n  while (index--) {\n    var data = matchData[index];\n    if ((noCustomizer && data[2])\n          ? data[1] !== object[data[0]]\n          : !(data[0] in object)\n        ) {\n      return false;\n    }\n  }\n  while (++index < length) {\n    data = matchData[index];\n    var key = data[0],\n        objValue = object[key],\n        srcValue = data[1];\n\n    if (noCustomizer && data[2]) {\n      if (objValue === undefined && !(key in object)) {\n        return false;\n      }\n    } else {\n      var stack = new Stack;\n      if (customizer) {\n        var result = customizer(objValue, srcValue, key, object, source, stack);\n      }\n      if (!(result === undefined\n            ? baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG, customizer, stack)\n            : result\n          )) {\n        return false;\n      }\n    }\n  }\n  return true;\n}\n\nexport default baseIsMatch;\n","import isObject from './isObject.js';\n\n/**\n * Checks if `value` is suitable for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` if suitable for strict\n *  equality comparisons, else `false`.\n */\nfunction isStrictComparable(value) {\n  return value === value && !isObject(value);\n}\n\nexport default isStrictComparable;\n","import isStrictComparable from './_isStrictComparable.js';\nimport keys from './keys.js';\n\n/**\n * Gets the property names, values, and compare flags of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the match data of `object`.\n */\nfunction getMatchData(object) {\n  var result = keys(object),\n      length = result.length;\n\n  while (length--) {\n    var key = result[length],\n        value = object[key];\n\n    result[length] = [key, value, isStrictComparable(value)];\n  }\n  return result;\n}\n\nexport default getMatchData;\n","/**\n * A specialized version of `matchesProperty` for source values suitable\n * for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction matchesStrictComparable(key, srcValue) {\n  return function(object) {\n    if (object == null) {\n      return false;\n    }\n    return object[key] === srcValue &&\n      (srcValue !== undefined || (key in Object(object)));\n  };\n}\n\nexport default matchesStrictComparable;\n","import baseIsMatch from './_baseIsMatch.js';\nimport getMatchData from './_getMatchData.js';\nimport matchesStrictComparable from './_matchesStrictComparable.js';\n\n/**\n * The base implementation of `_.matches` which doesn't clone `source`.\n *\n * @private\n * @param {Object} source The object of property values to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatches(source) {\n  var matchData = getMatchData(source);\n  if (matchData.length == 1 && matchData[0][2]) {\n    return matchesStrictComparable(matchData[0][0], matchData[0][1]);\n  }\n  return function(object) {\n    return object === source || baseIsMatch(object, source, matchData);\n  };\n}\n\nexport default baseMatches;\n","import baseIsEqual from './_baseIsEqual.js';\nimport get from './get.js';\nimport hasIn from './hasIn.js';\nimport isKey from './_isKey.js';\nimport isStrictComparable from './_isStrictComparable.js';\nimport matchesStrictComparable from './_matchesStrictComparable.js';\nimport toKey from './_toKey.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.matchesProperty` which doesn't clone `srcValue`.\n *\n * @private\n * @param {string} path The path of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatchesProperty(path, srcValue) {\n  if (isKey(path) && isStrictComparable(srcValue)) {\n    return matchesStrictComparable(toKey(path), srcValue);\n  }\n  return function(object) {\n    var objValue = get(object, path);\n    return (objValue === undefined && objValue === srcValue)\n      ? hasIn(object, path)\n      : baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG);\n  };\n}\n\nexport default baseMatchesProperty;\n","/**\n * The base implementation of `_.property` without support for deep paths.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction baseProperty(key) {\n  return function(object) {\n    return object == null ? undefined : object[key];\n  };\n}\n\nexport default baseProperty;\n","import baseGet from './_baseGet.js';\n\n/**\n * A specialized version of `baseProperty` which supports deep paths.\n *\n * @private\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction basePropertyDeep(path) {\n  return function(object) {\n    return baseGet(object, path);\n  };\n}\n\nexport default basePropertyDeep;\n","import baseProperty from './_baseProperty.js';\nimport basePropertyDeep from './_basePropertyDeep.js';\nimport isKey from './_isKey.js';\nimport toKey from './_toKey.js';\n\n/**\n * Creates a function that returns the value at `path` of a given object.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n * @example\n *\n * var objects = [\n *   { 'a': { 'b': 2 } },\n *   { 'a': { 'b': 1 } }\n * ];\n *\n * _.map(objects, _.property('a.b'));\n * // => [2, 1]\n *\n * _.map(_.sortBy(objects, _.property(['a', 'b'])), 'a.b');\n * // => [1, 2]\n */\nfunction property(path) {\n  return isKey(path) ? baseProperty(toKey(path)) : basePropertyDeep(path);\n}\n\nexport default property;\n","import baseMatches from './_baseMatches.js';\nimport baseMatchesProperty from './_baseMatchesProperty.js';\nimport identity from './identity.js';\nimport isArray from './isArray.js';\nimport property from './property.js';\n\n/**\n * The base implementation of `_.iteratee`.\n *\n * @private\n * @param {*} [value=_.identity] The value to convert to an iteratee.\n * @returns {Function} Returns the iteratee.\n */\nfunction baseIteratee(value) {\n  // Don't store the `typeof` result in a variable to avoid a JIT bug in Safari 9.\n  // See https://bugs.webkit.org/show_bug.cgi?id=156034 for more details.\n  if (typeof value == 'function') {\n    return value;\n  }\n  if (value == null) {\n    return identity;\n  }\n  if (typeof value == 'object') {\n    return isArray(value)\n      ? baseMatchesProperty(value[0], value[1])\n      : baseMatches(value);\n  }\n  return property(value);\n}\n\nexport default baseIteratee;\n","/**\n * This function is like `arrayIncludes` except that it accepts a comparator.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @param {Function} comparator The comparator invoked per element.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludesWith(array, value, comparator) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (comparator(value, array[index])) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport default arrayIncludesWith;\n","import Set from './_Set.js';\nimport noop from './noop.js';\nimport setToArray from './_setToArray.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Creates a set object of `values`.\n *\n * @private\n * @param {Array} values The values to add to the set.\n * @returns {Object} Returns the new set.\n */\nvar createSet = !(Set && (1 / setToArray(new Set([,-0]))[1]) == INFINITY) ? noop : function(values) {\n  return new Set(values);\n};\n\nexport default createSet;\n","import SetCache from './_SetCache.js';\nimport arrayIncludes from './_arrayIncludes.js';\nimport arrayIncludesWith from './_arrayIncludesWith.js';\nimport cacheHas from './_cacheHas.js';\nimport createSet from './_createSet.js';\nimport setToArray from './_setToArray.js';\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * The base implementation of `_.uniqBy` without support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new duplicate free array.\n */\nfunction baseUniq(array, iteratee, comparator) {\n  var index = -1,\n      includes = arrayIncludes,\n      length = array.length,\n      isCommon = true,\n      result = [],\n      seen = result;\n\n  if (comparator) {\n    isCommon = false;\n    includes = arrayIncludesWith;\n  }\n  else if (length >= LARGE_ARRAY_SIZE) {\n    var set = iteratee ? null : createSet(array);\n    if (set) {\n      return setToArray(set);\n    }\n    isCommon = false;\n    includes = cacheHas;\n    seen = new SetCache;\n  }\n  else {\n    seen = iteratee ? [] : result;\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee ? iteratee(value) : value;\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var seenIndex = seen.length;\n      while (seenIndex--) {\n        if (seen[seenIndex] === computed) {\n          continue outer;\n        }\n      }\n      if (iteratee) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n    else if (!includes(seen, computed, comparator)) {\n      if (seen !== result) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nexport default baseUniq;\n","import baseIteratee from './_baseIteratee.js';\nimport baseUniq from './_baseUniq.js';\n\n/**\n * This method is like `_.uniq` except that it accepts `iteratee` which is\n * invoked for each element in `array` to generate the criterion by which\n * uniqueness is computed. The order of result values is determined by the\n * order they occur in the array. The iteratee is invoked with one argument:\n * (value).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n * @returns {Array} Returns the new duplicate free array.\n * @example\n *\n * _.uniqBy([2.1, 1.2, 2.3], Math.floor);\n * // => [2.1, 1.2]\n *\n * // The `_.property` iteratee shorthand.\n * _.uniqBy([{ 'x': 1 }, { 'x': 2 }, { 'x': 1 }], 'x');\n * // => [{ 'x': 1 }, { 'x': 2 }]\n */\nfunction uniqBy(array, iteratee) {\n  return (array && array.length) ? baseUniq(array, baseIteratee(iteratee, 2)) : [];\n}\n\nexport default uniqBy;\n","@import \"../../styles/mixins/component-base.css\";\n\n:host {\n  display: block;\n}\n\n::slotted(.market-action-card) {\n  margin-bottom: var(--action-card-spacing);\n}\n\n::slotted(.market-input-search) {\n  margin-bottom: var(--core-metrics-spacing-100);\n}\n\n.hidden,\n::slotted(.hidden) {\n  display: none;\n}\n\n/* remove the bottom border of last visible row when there's a search query */\n::slotted(.market-row.hide-bottom-border)::before {\n  display: none;\n}\n\n.market-empty-state,\n::slotted(.market-empty-state) {\n  padding-right: 0;\n  padding-left: 0;\n  border: 0;\n}\n\n::slotted(.market-drag-cursor) {\n  --drag-cursor-height: 4px;\n\n  display: block;\n  height: 0;\n  outline: calc(var(--drag-cursor-height) / 2) solid var(--core-emphasis-fill-color);\n  pointer-events: none;\n}\n","import { Component, Listen, Element, Prop, EventEmitter, Event, Host, State, h, Watch, Method } from '@stencil/core';\nimport { uniqBy } from 'lodash-es';\n\nimport { getNamespacedTagFor } from '../../utils/namespace';\nimport { asyncRequestAnimationFrame } from '../../utils/raf';\nimport { TMarketInputSearchValueChangeEventDetail } from '../market-input-search/events';\n\nimport { Reorderable, TMarketReorderableOptions, TMarketReorderEventDetail } from '../../utils/reorderable';\nimport { isDraggable, TMarketDragEventDetail } from '../../utils/draggable';\n\nimport { TMarketListItemsFilteredEventDetail, TMarketListSelectionsDidChangeEventDetail } from './events';\nimport {\n  ListItemSelectableType,\n  TMarketListFilterStrategyPropTypes,\n  TMarketListItem,\n  TMarketListValidControlRowInputElement,\n} from './types';\nimport { getItemSelectableType, isValidControl, isValueEmpty } from './utils';\n\n/* If Stencil supported extending built-in elements, I would much prefer to extend the <li>\nelement instead of creating a completely different one here, but unlike buttons and anchors,\nthe default <li> tag doesn't provide a whole lot over a custom element aside from semantics */\n\n/**\n * @slot control-row - Intended for use with interactive multiselect lists. When used with a\n * `<market-row>` containing a slotted control (such as `<market-checkbox>`), toggling this row\n * will select/deselect all list options.\n * @slot search - Intended for use with `<market-input-search>`\n * @slot empty-state - Intended for use with `<market-empty-state>`; shown when filtering items\n * via `<market-input-search>` and there are no search results.\n * @slot - Intended for use with `<market-row>` or `<market-action-card>`.\n */\n@Component({\n  tag: 'market-list',\n  shadow: true,\n  styleUrl: 'market-list.css',\n})\nexport class MarketList {\n  @Element() el: HTMLMarketListElement;\n  inputSearchEl: HTMLMarketInputSearchElement;\n  controlRow: HTMLMarketRowElement;\n  observers: {\n    itemDisabledAttribute?: MutationObserver;\n  } = {};\n\n  /**\n   * A string specifying a value for the list. To select multiple values,\n   * separate **unique** values with a comma (e.g. `'orange,pear'`).\n   * Setting to empty string (`''`) will clear all current selections.\n   */\n  @Prop({ mutable: true, reflect: true }) value: string | Array<any> = '';\n\n  /**\n   * Whether or not the list is interactive. Results in list items receiving hover\n   * and active styling when hovered/clicked.<br>\n   *\n   * _NOTE:_ Lists slotted into `market-popover`, or any of the components that use it\n   * internally such as `market-select`, `market-dropdown`, and `market-button-dropdown`,\n   * will automatically have their `interactive` property set to `true`.\n   */\n  @Prop({ mutable: true }) interactive: boolean = false;\n\n  /**\n   * When set to `true`, rows/cards will not persist selected state on click. Only takes effect when `interactive` is true.\n   */\n  @Prop() readonly transient: boolean = false;\n\n  /**\n   * Whether or not the list can allow for multiple selections (currently not\n   * reflected in the `value` prop)\n   */\n  @Prop({ reflect: true }) readonly multiselect: boolean = false;\n\n  /**\n   * String value used for the `aria-labelledby` attribute.\n   */\n  @Prop() readonly name: string;\n\n  /**\n   * Filter strategy\n   *\n   * - `\"textcontent\"` (default, case-insensitive): This strategy searches through each of the row’s `.textContent`. This means it would also search through a row’s subtext, accessories, and other slots.\n   * - `\"label\"` (case-insensitive): This strategy searches through the slotted `<label>` elements of rows. Note that if a `<label>` is not slotted in a row, this default filter strategy will not work.\n   * - `\"value\"` (case-sensitive): This strategy searches through the rows’ `value` attribute. Values are usually case-sensitive so they are treated the same way when searching for them.\n   * - `Function`: This strategy works similarly to `Array.prototype.filter()` where the function’s `boolean` output determines if the item will be kept or filtered out. For your convenience, you are provided with 5 parameters:\n   *   - `item`: `TMarketListItem`\n   *   - `label`: the `<label>`’s `.textContent`\n   *   - `query`: `value` of `<market-input-search>`\n   *   - `textContent`: the item’s `.textContent`\n   *   - `value`: `value` of the item\n   */\n  @Prop() readonly filterStrategy: TMarketListFilterStrategyPropTypes = 'textcontent';\n\n  /**\n   * Whether the list is reorderable or not.\n   * Setting to `internal` enables reordering rows internally\n   * while `external` also allows dragging to & from other lists.\n   */\n  @Prop({ reflect: true }) readonly reorderable: TMarketReorderableOptions = 'off';\n\n  /**\n   * When set to `framework`, the list will move the reordered row back to its original position\n   * before the `marketListItemsReordered` event is fired. This is useful when the list\n   * is rendered within a framework like Ember or React.\n   */\n  @Prop() readonly reorderMode: 'default' | 'framework' = 'default';\n\n  /**\n   * Whether a count of selectable items rendered within the control row will be hidden\n   */\n  @Prop({ reflect: true }) readonly hideSelectableCount: boolean = false;\n\n  /**\n   * Used to indicate if the list has a search input\n   */\n  @State() hasSearch: boolean = false;\n\n  /**\n   * All items\n   */\n  @State() items: Array<TMarketListItem>;\n\n  /**\n   * Current itemselections\n   */\n  @State() selections: Set<TMarketListItem> = new Set();\n\n  /**\n   * Filtered items by `market-input-search`\n   */\n  @State() filteredItems: {\n    visible: Array<TMarketListItem>;\n    hidden: Array<TMarketListItem>;\n    visibleSelected: Array<TMarketListItem>;\n    selected: Array<TMarketListItem>;\n  };\n\n  @Watch('reorderable')\n  reorderableWatcher() {\n    this.setReorderable();\n  }\n\n  /**\n   * Fired whenever an item is selected or deselected.\n   *\n   * @property {TMarketListItem} newSelection\n   * - the row or card that has been selected\n   * @property {string} newSelectionValue - the value of the new selection\n   * @property {TMarketListItem} newDeselection\n   * - the row or card that has been deselected\n   * @property {string} newDeselectionValue - the value of the new deselection\n   * @property {Array<TMarketListItem>} currentSelections\n   * - an array of the currently selected rows or cards (excludes slotted control row, if any)\n   * @property {string[]} currentSelectionValues - an array of the currently selected values\n   * (excludes slotted control row, if any)\n   * @property {string[]} prevSelectionValues - an array of the previously selected values\n   * (excludes slotted control row, if any)\n   */\n  @Event({ bubbles: true, composed: true })\n  marketListSelectionsDidChange: EventEmitter<TMarketListSelectionsDidChangeEventDetail>;\n\n  /**\n   * Fired when the slotchange event happens on the list. Allows parent components (like `market-select`)\n   * to update when slotted list items change.\n   */\n  @Event({ bubbles: true, composed: true }) marketListSlotChange: EventEmitter;\n\n  /**\n   * Fired when the list items are reordered.\n   * If an item was dropped into this list from an external list, `oldIndex` is `-1`.\n   * If an item was removed from this list and dropped into an external list, `newIndex` is `-1`.\n   */\n  @Event({ bubbles: false, composed: true }) marketListItemsReordered: EventEmitter<TMarketReorderEventDetail>;\n\n  /**\n   * Fired when items are filtered using `market-input-search`\n   */\n  @Event({ bubbles: true, composed: true }) marketListItemsFiltered: EventEmitter<TMarketListItemsFilteredEventDetail>;\n\n  @Watch('value')\n  valueWatcher() {\n    this.setSelectionsFromValue();\n  }\n\n  @Watch('hideSelectableCount')\n  hideSelectableCountWatcher() {\n    this.injectCountOnControlRow();\n  }\n\n  /* Listen for the marketRowSelected event which is emitted by slotted market-row elements\n  when they are clicked */\n  @Listen('marketRowSelected')\n  rowSelectedEventHandler(e: CustomEvent) {\n    this.handleItemSelectedEvent(e.target as HTMLMarketRowElement);\n  }\n\n  /* Listen for the marketRowDeselected event which is emitted by slotted market-row elements\n  when they are clicked */\n  @Listen('marketRowDeselected')\n  rowDeselectedEventHandler(e: CustomEvent) {\n    this.handleItemDeselectedEvent(e.target as HTMLMarketRowElement);\n  }\n\n  /* Listen for the marketCardSelected event which is emitted by slotted market-action-card elements\n  when they are clicked */\n  @Listen('marketCardSelected')\n  cardSelectedEventHandler(e: CustomEvent) {\n    this.handleItemSelectedEvent(e.target as HTMLMarketActionCardElement);\n  }\n\n  /* Listen for the marketCardDeselected event which is emitted by slotted market-action-card elements\n  when they are clicked */\n  @Listen('marketCardDeselected')\n  cardDeselectedEventHandler(e: CustomEvent) {\n    this.handleItemDeselectedEvent(e.target as HTMLMarketActionCardElement);\n  }\n\n  /**\n   * Listen for `marketInputSearchValueChange` which is emitted by the slotted `market-input-search`\n   */\n  @Listen('marketInputSearchValueChange')\n  marketInputSearchValueChangeEventHander({ detail }: CustomEvent<TMarketInputSearchValueChangeEventDetail>) {\n    this.filterItems(detail.value);\n  }\n\n  getEventSelectionDetails() {\n    const prevSelectionValues = (() => {\n      if (typeof this.value === 'string') {\n        return this.value ? this.value.split(',').filter((value) => !isValueEmpty(value)) : [];\n      } else if (Array.isArray(this.value)) {\n        return this.value.filter((value) => !isValueEmpty(value));\n      }\n      return this.value;\n    })();\n    const currentSelections = uniqBy(\n      [...this.selections].filter((item) => item !== this.controlRow),\n      (item) => item.value, // ensure uniqueness by value\n    );\n    const currentSelectionValues = currentSelections.reduce((items, item) => {\n      if (!isValueEmpty(item.value)) {\n        items.push(item.value);\n      }\n      return items;\n    }, [] as TMarketListItem['value'][]);\n    return { currentSelections, currentSelectionValues, prevSelectionValues };\n  }\n\n  handleItemSelectedEvent(selectedItem: TMarketListItem) {\n    if (selectedItem === this.controlRow) {\n      this.selectAllItems();\n    } else {\n      this.selectItem(selectedItem);\n    }\n\n    const { currentSelections, currentSelectionValues, prevSelectionValues } = this.getEventSelectionDetails();\n    this.value = currentSelectionValues.join(','); // reflect to DOM\n\n    this.marketListSelectionsDidChange.emit({\n      newSelection: selectedItem,\n      newSelectionValue: selectedItem.value,\n      newDeselection: null,\n      newDeselectionValue: null,\n      currentSelections,\n      currentSelectionValues,\n      prevSelectionValues,\n    });\n  }\n\n  handleItemDeselectedEvent(deselectedItem: TMarketListItem) {\n    // We check to see if the element is in our selections, since we may have\n    // already manually deselected it due to another element being clicked.\n    // We only want the code in the block to fire when `marketRowDeselected` is being\n    // emitted due to a merchant actually clicking to deselect an element.\n    if (!this.selections.has(deselectedItem)) {\n      return;\n    }\n\n    if (deselectedItem === this.controlRow) {\n      /**\n       * special case: when the only remaining selected items are disabled,\n       * the control row's checkbox will be indeterminate (expected UI behavior).\n       * when normally, clicking a row with an indeterminate checkbox selects all,\n       * in this case, we want it to select all (non-disabled items) instead.\n       */\n      const shouldSelectAll = (() => {\n        const items = (this.filteredItems?.visible ?? this.items).filter((item) => item !== this.controlRow);\n        const nonDisabledItems = items.filter((item) => !item.disabled);\n        return nonDisabledItems.every((item) => !item.selected);\n      })();\n      if (shouldSelectAll) {\n        this.selectAllItems();\n      } else {\n        this.deselectAllItems();\n      }\n    } else {\n      this.deselectItem(deselectedItem);\n    }\n\n    const { currentSelections, currentSelectionValues, prevSelectionValues } = this.getEventSelectionDetails();\n    this.value = currentSelectionValues.join(','); // reflect to DOM\n\n    this.marketListSelectionsDidChange.emit({\n      newSelection: null,\n      newSelectionValue: null,\n      newDeselection: deselectedItem,\n      newDeselectionValue: deselectedItem.value,\n      currentSelections,\n      currentSelectionValues,\n      prevSelectionValues,\n    });\n  }\n\n  /**\n   * Selects a given option from the list. Also handles deselecting\n   * all other elements when not in multiselect mode.\n   */\n  selectItem(selectedItem: TMarketListItem) {\n    /* Only if this list is interactive and *doesn't* allow multiple selections,\n    deselect all the options except the one that was just selected */\n    if (this.interactive) {\n      if (!this.multiselect) {\n        this.deselectItems([selectedItem]);\n        this.selections = new Set([selectedItem]);\n      } else {\n        this.selections.add(selectedItem);\n      }\n    }\n  }\n\n  /**\n   * Selects all multiselect list options.\n   */\n  selectAllItems() {\n    if (!this.items || !this.interactive || !this.multiselect) {\n      return;\n    }\n\n    // if items are being filtered, \"Select all\" only applies to visible items\n    // and then filter all non-disabled items to already selected items (might include disabled items)\n    const selectableItems = (this.filteredItems?.visible || this.items).filter((item) => !item.disabled);\n    this.selections = new Set([...this.selections.values(), ...selectableItems]);\n  }\n\n  /**\n   * Deselects a given option from the list.\n   */\n  deselectItem(deselectedItem: TMarketListItem) {\n    this.selections.delete(deselectedItem);\n  }\n\n  /**\n   * Deselects all other items other than the ones that were just selected.\n   */\n  deselectItems(selectedItems: Array<TMarketListItem>) {\n    if (!this.items) {\n      return;\n    }\n\n    this.items.forEach((item) => {\n      /* Check to make sure the item isn't in the list of\n        selected items (likely only the one that was just\n        selected and triggered the callback) */\n      if (!selectedItems.includes(item) && item.selected) {\n        item.deselect();\n      }\n    });\n  }\n\n  /**\n   * Deselects all list options.\n   */\n  deselectAllItems() {\n    if (!this.selections || !this.interactive) {\n      return;\n    }\n\n    /**\n     * If items are being filtered, only deselect visible items.\n     * Disabled items will not be deselected.\n     */\n    const visibleItemsSet = new Set(this.filteredItems?.visible ?? this.items);\n    const selectedItemsToKeep = [...this.selections].filter((selectedItem) => {\n      return selectedItem.disabled || !visibleItemsSet.has(selectedItem);\n    });\n    this.selections = new Set(selectedItemsToKeep);\n  }\n\n  /**\n   * If passed or updates interactive, ensure list itself is set to interactive mode.\n   */\n  syncListInteractiveWithItems() {\n    if (\n      this.items.length > 0 &&\n      (this.items[0].tagName === getNamespacedTagFor('market-action-card').toUpperCase() ||\n        (this.items[0].tagName === getNamespacedTagFor('market-row').toUpperCase() &&\n          (this.items[0] as HTMLMarketRowElement).interactive === true)) &&\n      !this.interactive\n    ) {\n      // force list to be interactive if items are interactive rows\n      // (i.e. when they contain slotted controls), or\n      // items are action cards (which are always interactive)\n      this.interactive = true;\n    }\n  }\n\n  /**\n   * Processes interactive, transient, and multiselect props and propagates these props\n   * to children components whenever these props are updated.\n   */\n  processItems() {\n    this.items.forEach((item) => {\n      if (item.tagName === getNamespacedTagFor('market-action-card').toUpperCase()) {\n        item.transient = this.transient;\n\n        const cardRow = item.querySelector<HTMLMarketRowElement>(getNamespacedTagFor('market-row'));\n        if (cardRow) {\n          this.setRowProperties(cardRow);\n        }\n      } else {\n        this.setRowProperties(item as HTMLMarketRowElement);\n      }\n    });\n  }\n\n  getCurrentSelectionValues(): Set<string> {\n    if (Array.isArray(this.value)) {\n      return new Set(this.value);\n    }\n    return new Set(this.multiselect ? this.value.split(',') : [this.value]);\n  }\n\n  setRowProperties(row: HTMLMarketRowElement) {\n    row.interactive = this.interactive;\n    row.transient = this.transient;\n\n    // We don't want subsequent clicks to deselect rows for single select lists\n    row.togglable = this.multiselect;\n  }\n\n  /**\n   * Select item that corresponds to passed value, or clear all values if value is empty string.\n   */\n  setSelectionsFromValue() {\n    if (this.value || this.value === '') {\n      const values = this.getCurrentSelectionValues();\n      this.items?.forEach((item) => {\n        if (item === this.controlRow) {\n          // control row selection happens in syncControlRowWithSelections\n          return;\n        }\n        if (!isValueEmpty(this.value) && values.has(item.value)) {\n          item.silentlySelect();\n          this.selectItem(item);\n        } else {\n          // value is '', so deselect all items\n          item.silentlyDeselect();\n          this.deselectItem(item);\n        }\n      });\n    }\n  }\n\n  /**\n   * Find any list items with the `selected` property and add to `selections`.\n   */\n  setSelectionsFromRowAttributes() {\n    const initialSelections: Set<TMarketListItem> = new Set();\n    this.items.forEach((item) => {\n      if (item.selected) {\n        /* TODO: Maybe figure out how to handle the case where the\n         * list is not multiselect, but more than one market-row has the\n         * [selected] attribute */\n        initialSelections.add(item);\n      }\n    });\n\n    this.selections = initialSelections;\n  }\n\n  setListAndItemsRoles() {\n    const itemSelectableTypes = this.items.map((item) => getItemSelectableType(item));\n    const allItemsHaveSameSelectableType =\n      itemSelectableTypes.every((type) => type === ListItemSelectableType.CHECKBOX) ||\n      itemSelectableTypes.every((type) => type === ListItemSelectableType.RADIO) ||\n      itemSelectableTypes.every((type) => type === ListItemSelectableType.SWITCH) ||\n      itemSelectableTypes.every((type) => type === ListItemSelectableType.SELECTABLE_WITHOUT_CONTROL);\n\n    if (allItemsHaveSameSelectableType) {\n      this.el.setAttribute('role', 'listbox');\n      this.items.forEach((item) => {\n        item.setAttribute('role', 'option');\n      });\n      this.el.setAttribute('aria-multiselectable', this.multiselect ? 'true' : 'false');\n    } else {\n      this.el.setAttribute('role', 'list');\n      this.items.forEach((item) => {\n        item.setAttribute('role', 'listitem');\n      });\n    }\n\n    if (this.value) {\n      this.setSelectionsFromValue();\n    } else {\n      this.setSelectionsFromRowAttributes();\n    }\n  }\n\n  /**\n   * Sets the initial state of the list by updating and propagating props and setting\n   * default value.\n   */\n  setInternalState() {\n    this.items = [\n      ...this.el.querySelectorAll<TMarketListItem>(\n        `:scope > ${getNamespacedTagFor('market-row')}, :scope > ${getNamespacedTagFor('market-action-card')}`,\n      ),\n    ];\n\n    if (this.items.length === 0) {\n      return;\n    }\n\n    this.syncListInteractiveWithItems();\n    this.processItems();\n    this.setListAndItemsRoles();\n\n    if (this.value) {\n      this.setSelectionsFromValue();\n    } else {\n      this.setSelectionsFromRowAttributes();\n    }\n  }\n\n  /**\n   * Syncs the state of the slotted control row with list selections (e.g. all selected, none\n   * selected, some selected).\n   */\n  async syncControlRowWithSelections() {\n    if (!this.controlRow) {\n      return;\n    }\n\n    const slottedControl = this.controlRow.querySelector('[slot=\"control\"]') as TMarketListValidControlRowInputElement;\n    const isCheckbox = slottedControl.tagName.toLowerCase() === getNamespacedTagFor('market-checkbox');\n\n    const items = (this.filteredItems?.visible ?? this.items).filter((item) => item !== this.controlRow);\n    const controlRowStatus = (() => {\n      if (items.every((item) => item.selected)) {\n        // all non-disabled items are selected\n        return 'checked';\n      } else if (items.some((item) => item.selected)) {\n        // at least one is selected (regardless if it's disabled or not)\n        return 'indeterminate';\n      } else {\n        return 'unchecked';\n      }\n    })();\n\n    switch (controlRowStatus) {\n      case 'unchecked':\n        // no options selected, deselect control row\n        this.deselectItem(this.controlRow);\n        await this.controlRow.silentlyDeselect();\n        await asyncRequestAnimationFrame(); // prevents flash where it goes from indeterminate -> checked -> unchecked\n        slottedControl.removeAttribute('indeterminate');\n        break;\n      case 'checked':\n        // all options selected, select control row\n        await this.controlRow.silentlySelect();\n        this.selectItem(this.controlRow);\n        slottedControl.removeAttribute('indeterminate');\n        break;\n      case 'indeterminate':\n        // some options selected\n        if (isCheckbox) {\n          // control row gets selected, checkbox set to indeterminate\n          await this.controlRow.silentlySelect();\n          this.selectItem(this.controlRow);\n          await asyncRequestAnimationFrame(); // prevents bug where checkbox becomes checked but not indeterminate\n          slottedControl.setAttribute('indeterminate', '');\n        } else {\n          // control row gets deselected\n          await this.controlRow.silentlyDeselect();\n          this.deselectItem(this.controlRow);\n        }\n        break;\n      default:\n        break;\n    }\n\n    this.injectCountOnControlRow();\n  }\n\n  /**\n   * Injects an accessory to the control row that displays the number of items;\n   * or edit that accessory's text content if the element already exists.\n   *\n   * Disabled items are not included in the count.\n   *\n   * Count is only rendered when `hideSelectableCount` is `false`, which it is by default.\n   */\n  injectCountOnControlRow() {\n    if (!this.controlRow) {\n      return;\n    }\n    const countAccessoryEl = this.controlRow.querySelector('.count[slot=\"trailing-accessory\"]');\n    if (this.hideSelectableCount) {\n      if (countAccessoryEl) {\n        this.controlRow.removeChild(countAccessoryEl);\n      }\n      return;\n    }\n\n    const count = this.filteredItems.visible.filter((item) => !item.disabled).length;\n    if (countAccessoryEl) {\n      countAccessoryEl.textContent = `${count}`;\n    } else {\n      const newEl = document.createElement('span');\n      newEl.classList.add('count');\n      newEl.setAttribute('slot', 'trailing-accessory');\n      newEl.textContent = `${count}`;\n      this.controlRow.appendChild(newEl);\n    }\n  }\n\n  /**\n   * Filters items based on search query inputted in slotted `market-input-search`\n   */\n  filterItems(query: string) {\n    const filteredItems: typeof this.filteredItems = this.items.reduce(\n      (filteredItems, item) => {\n        if (item.getAttribute('slot') === 'control-row') {\n          // filteredItems will not contain the control row as it isn't needed for logic purposes\n          return filteredItems;\n        } else if (!query) {\n          // if there's no search query, all items are visible\n          filteredItems.visible.push(item);\n          return filteredItems;\n        } else if (typeof this.filterStrategy === 'function') {\n          // attempts to call the provided function\n          const callbackResult = this.filterStrategy({\n            item,\n            label: item.querySelector('[slot=\"label\"]')?.textContent,\n            query,\n            textContent: item.textContent,\n            value: item.value,\n          });\n          if (callbackResult) {\n            filteredItems.visible.push(item);\n            return filteredItems;\n          }\n        } else if (this.filterStrategy?.toLocaleLowerCase?.() === 'textcontent') {\n          // search through the entire item's textContent\n          const isFound = item?.textContent?.search(new RegExp(query, 'i')) >= 0;\n          if (isFound) {\n            filteredItems.visible.push(item);\n            return filteredItems;\n          }\n        } else if (this.filterStrategy?.toLocaleLowerCase?.() === 'label') {\n          // only works if there's a slotted label\n          const labelEl = item.querySelector('[slot=\"label\"]');\n          const isFound = labelEl?.textContent?.search(new RegExp(query, 'i')) >= 0;\n          if (isFound) {\n            filteredItems.visible.push(item);\n            return filteredItems;\n          }\n        } else if (this.filterStrategy?.toLocaleLowerCase?.() === 'value') {\n          // if the item's value isn't a string, it may not work well UX-wise\n          const value = String(item.value);\n          const isFound = value.search(new RegExp(query)) >= 0;\n          if (isFound) {\n            filteredItems.visible.push(item);\n            return filteredItems;\n          }\n        }\n        // item didn't pass any of the conditions / filter strategies above\n        filteredItems.hidden.push(item);\n        return filteredItems;\n      },\n      {\n        visible: [],\n        hidden: [],\n        visibleSelected: [],\n        selected: [],\n      },\n    );\n\n    // DOM manipulation\n    requestAnimationFrame(() => {\n      // make sure that visible items are visible, hidden items are hidden\n      filteredItems.visible.forEach((item) => item.classList.remove('hidden'));\n      filteredItems.hidden.forEach((item) => item.classList.add('hidden'));\n\n      // hide last visible item's bottom border\n      this.items.forEach((item) => item.classList.remove('hide-bottom-border'));\n      if (filteredItems.visible.length > 0) {\n        const lastVisibleItem = filteredItems.visible[filteredItems.visible.length - 1];\n        lastVisibleItem.classList.add('hide-bottom-border');\n      }\n\n      // hide control row if there are no search results\n      this.controlRow?.classList.toggle('hidden', filteredItems.visible.length === 0);\n    });\n\n    // will not emit when the list is initially rendered without a search query\n    if (this.filteredItems || (!this.filteredItems && query)) {\n      this.marketListItemsFiltered.emit({\n        items: filteredItems.visible,\n        prevItems: this.filteredItems?.visible,\n      });\n    }\n\n    // this triggers a re-render since `this.filteredItems` is a `@State`\n    this.filteredItems = filteredItems;\n    this.updateSelectedItemsInFilteredItems();\n  }\n\n  updateSelectedItemsInFilteredItems() {\n    if (!this.filteredItems) {\n      return;\n    }\n    this.filteredItems.selected = this.items.filter(\n      (item) => item.getAttribute('slot') !== 'control-row' && item.selected,\n    );\n    this.filteredItems.visibleSelected = this.filteredItems.visible.filter(\n      (item) => item.getAttribute('slot') !== 'control-row' && item.selected,\n    );\n  }\n\n  /* SLOTCHANGE HANDLERS */\n\n  handleSearchSlotchange() {\n    this.inputSearchEl = this.el.querySelector('[slot=\"search\"]');\n    this.hasSearch = Boolean(this.inputSearchEl);\n    this.filterItems(this.inputSearchEl?.value);\n  }\n\n  defaultSlotchangeHandler() {\n    this.setInternalState();\n    this.filterItems(this.inputSearchEl?.value);\n    this.setReorderable();\n    this.marketListSlotChange.emit();\n  }\n\n  /**\n   * Rows slotted into the \"control-row\" slot only function as such if the list is interactive and\n   * multiselect and the row contains a valid slotted control (checkbox or toggle).\n   */\n  controlRowSlotchangeHandler() {\n    if (!this.interactive || !this.multiselect) {\n      return;\n    }\n\n    const slottedRow = this.el.querySelector('[slot=\"control-row\"]') as HTMLMarketRowElement;\n    const slottedControl = slottedRow?.querySelector('[slot=\"control\"]');\n    this.controlRow = isValidControl(slottedControl) ? slottedRow : undefined;\n  }\n\n  /**\n   * Show empty state if:\n   * - list isn't empty, but\n   * - there is a search query, and\n   * - there are no search results\n   */\n  setEmptyStateVisibility() {\n    const emptyStateEl =\n      this.el.querySelector('[slot=\"empty-state\"]') ||\n      this.el.shadowRoot.querySelector(getNamespacedTagFor('market-empty-state'));\n    const willShowEmptyState = this.inputSearchEl?.value && !this.filteredItems?.visible.length;\n    emptyStateEl?.classList.toggle('hidden', !willShowEmptyState);\n  }\n\n  /**\n   * Updates the count that is injected to the control row\n   * when there’s a change on an item’s `disabled` attribute.\n   */\n  initItemDisabledAttributeObserver() {\n    if (this.observers.itemDisabledAttribute) {\n      return;\n    }\n    this.observers.itemDisabledAttribute = new MutationObserver((mutations) => {\n      for (const mutation of mutations) {\n        if (\n          mutation.target.parentElement === this.el &&\n          mutation.type === 'attributes' &&\n          mutation.attributeName === 'disabled'\n        ) {\n          this.injectCountOnControlRow();\n        }\n      }\n    });\n    this.observers.itemDisabledAttribute.observe(this.el, {\n      attributes: true,\n      attributeFilter: ['disabled'],\n      childList: true,\n      subtree: true,\n    });\n  }\n\n  /* LIFECYCLE EVENTS */\n  connectedCallback() {\n    this.syncControlRowWithSelections();\n  }\n\n  componentWillLoad() {\n    this.setInternalState();\n    this.filterItems(this.inputSearchEl?.value);\n  }\n\n  componentWillRender() {\n    this.syncListInteractiveWithItems();\n    this.processItems();\n    this.setListAndItemsRoles();\n    this.updateSelectedItemsInFilteredItems();\n    this.controlRowSlotchangeHandler();\n    this.syncControlRowWithSelections();\n    this.setEmptyStateVisibility();\n  }\n\n  componentDidLoad() {\n    this.initItemDisabledAttributeObserver();\n  }\n\n  disconnectedCallback() {\n    this.observers.itemDisabledAttribute?.disconnect();\n  }\n\n  /*\n    KEYBOARD ACCESSIBILITY\n\n    tabbing goes through rows (and slotted controls, if any) once before moving\n    on to rest of page content\n\n    once list has focus, up/down arrows can move focus up/down, stopping at end\n    of list rather than cycling through (similar to native html <select>)\n    - https://developer.mozilla.org/en-US/docs/Web/HTML/Element/select\n\n    if slotted row contents have focus, up/down arrows do nothing\n  */\n  handleKeydown(e: KeyboardEvent) {\n    switch (e.key) {\n      case 'ArrowDown':\n        this.handleArrowDown(e);\n        break;\n      case 'ArrowUp':\n        this.handleArrowUp(e);\n        break;\n      default:\n        break;\n    }\n  }\n\n  handleArrowDown(e) {\n    const focused = this.el.querySelector(':focus');\n    const prevFocusedRowIndex = [...this.items].indexOf(focused as TMarketListItem);\n\n    // return if no rows are focused\n    if (prevFocusedRowIndex === -1) {\n      return;\n    }\n\n    // focus next enabled row\n    for (let i = prevFocusedRowIndex + 1; i < this.items.length; i++) {\n      if (!this.items[i].disabled) {\n        this.items[i].focus();\n        break;\n      }\n    }\n    e.preventDefault(); // down arrow should not scroll page\n  }\n\n  handleArrowUp(e) {\n    const focused = this.el.querySelector(':focus');\n    const prevFocusedRowIndex = [...this.items].indexOf(focused as TMarketListItem);\n\n    // return if no rows are focused\n    if (prevFocusedRowIndex === -1) {\n      return;\n    }\n\n    // focus last enabled row\n    for (let i = prevFocusedRowIndex - 1; i >= 0; i--) {\n      if (!this.items[i].disabled) {\n        this.items[i].focus();\n        break;\n      }\n    }\n    e.preventDefault(); // up arrow should not scroll page\n  }\n\n  /**\n   * Focuses the row at the given index.\n   * @param index - The index of the row to focus.\n   * @returns A promise that resolves when the row is focused.\n   */\n  @Method()\n  async focusRowAtIndex(index: number) {\n    const row = this.items[index];\n    if (row) {\n      row.focus();\n      return Promise.resolve();\n    } else {\n      return Promise.reject(new Error(`Row at index ${index} not found`));\n    }\n  }\n\n  // market reorder utils\n  reorder: Reorderable;\n\n  setReorderable() {\n    const { el, items, controlRow, reorderable, reorderMode, reorder, marketListItemsReordered } = this;\n\n    if (reorderable === 'off') {\n      reorder?.destroy();\n      this.reorder = null;\n    } else if (!reorder) {\n      this.reorder = new Reorderable({\n        el,\n        accepts: [`${getNamespacedTagFor('market-row')}:not([slot=\"control\"])`],\n        event: marketListItemsReordered,\n        mode: reorderMode,\n      });\n    }\n\n    items?.forEach((item) => {\n      if (!isDraggable(item)) return;\n      if (item === controlRow) return; // control row is not reorderable\n      item.dragEnabled = reorderable !== 'off';\n    });\n  }\n\n  onDragMove(e: CustomEvent<TMarketDragEventDetail>) {\n    this.reorder?.dragMove(e);\n  }\n  onDragLeave() {\n    this.reorder?.dragLeave();\n  }\n  onDragEnd(e: CustomEvent<TMarketDragEventDetail>) {\n    this.reorder?.dragEnd(e);\n  }\n  onDragDrop(e: CustomEvent<TMarketDragEventDetail>) {\n    this.reorder?.dragDrop(e);\n  }\n\n  componentDidRender() {\n    this.setReorderable();\n  }\n\n  render() {\n    const MarketEmptyState = getNamespacedTagFor('market-empty-state');\n\n    return (\n      <Host\n        class=\"market-list\"\n        aria-labelledby={this.name}\n        has-search={this.hasSearch}\n        onKeydown={(e: KeyboardEvent) => this.handleKeydown(e)}\n        onMarketDragMove={(e: CustomEvent<TMarketDragEventDetail>) => this.onDragMove(e)}\n        onMarketDragLeave={() => this.onDragLeave()}\n        onMarketDragEnd={(e: CustomEvent<TMarketDragEventDetail>) => this.onDragEnd(e)}\n        onMarketDragDrop={(e: CustomEvent<TMarketDragEventDetail>) => this.onDragDrop(e)}\n      >\n        <slot name=\"search\" onSlotchange={() => this.handleSearchSlotchange()}></slot>\n        <slot name=\"control-row\" onSlotchange={() => this.controlRowSlotchangeHandler()}></slot>\n        <slot onSlotchange={() => this.defaultSlotchangeHandler()}></slot>\n        <slot name=\"empty-state\">\n          <MarketEmptyState class=\"hidden\">\n            <svg height=\"40\" slot=\"media\" viewBox=\"0 0 40 40\" width=\"40\" xmlns=\"http://www.w3.org/2000/svg\">\n              <path\n                d=\"M34.4667 17.2L28.1 10.8333H26.6667C26.6667 9.45 25.55 8.33333 24.1667 8.33333C22.7834 8.33333 21.6667 9.45 21.6667 10.8333H18.3334C18.3334 9.45 17.2167 8.33333 15.8334 8.33333C14.45 8.33333 13.3334 9.45 13.3334 10.8333H11.9L5.53337 17.2C4.11671 18.6167 3.33337 20.5 3.33337 22.5C3.33337 26.6333 6.70004 30 10.8334 30C14.8 30 18.0167 26.9 18.2834 23.0167C18.8167 23.2167 19.4 23.3333 20 23.3333C20.6 23.3333 21.1834 23.2167 21.7167 23.0167C21.9834 26.9 25.2 30 29.1667 30C33.3 30 36.6667 26.6333 36.6667 22.5C36.6667 20.5 35.8834 18.6167 34.4667 17.2ZM10.8334 26.6667C8.53337 26.6667 6.66671 24.8 6.66671 22.5C6.66671 21.3833 7.10004 20.3333 7.88337 19.55C8.66671 18.7667 9.71671 18.3333 10.8334 18.3333C13.1334 18.3333 15 20.2 15 22.5C15 24.8 13.1334 26.6667 10.8334 26.6667ZM15.35 16.55C14.4667 15.8833 13.4334 15.3833 12.3 15.15L13.2667 14.1667H17.2334C16.3834 14.7333 15.7167 15.5667 15.35 16.55ZM20 20C19.0834 20 18.3334 19.25 18.3334 18.3333C18.3334 17.4167 19.0834 16.6667 20 16.6667C20.9167 16.6667 21.6667 17.4167 21.6667 18.3333C21.6667 19.25 20.9167 20 20 20ZM22.75 14.1667H26.7167L27.7 15.15C26.5667 15.3833 25.5334 15.8833 24.65 16.55C24.2834 15.5667 23.6167 14.7333 22.75 14.1667ZM29.1667 26.6667C26.8667 26.6667 25 24.8 25 22.5C25 20.2 26.8667 18.3333 29.1667 18.3333C30.2834 18.3333 31.3334 18.7667 32.1167 19.55C32.9 20.3333 33.3334 21.3833 33.3334 22.5C33.3334 24.8 31.4667 26.6667 29.1667 26.6667Z\"\n                fill=\"var(--core-text-10-color)\"\n                fill-opacity=\"0.9\"\n              />\n            </svg>\n            <h3 slot=\"primary-text\">\n              <slot name=\"empty-state-primary-text\">No search results for “{this.inputSearchEl?.value}”</slot>\n            </h3>\n            <p slot=\"secondary-text\">\n              <slot name=\"empty-state-secondary-text\">Try a different search.</slot>\n            </p>\n          </MarketEmptyState>\n        </slot>\n      </Host>\n    );\n  }\n}\n"],"mappings":"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"}