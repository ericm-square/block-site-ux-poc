import{r as e,c as t,h as o,H as a,g as r}from"./p-c9795ae2.js";import{g as s}from"./p-a7d431c5.js";const l=(e,t=2)=>{if(!Number(e))return"0 bytes";const o=1024;const a=t<0?0:t;const r=["bytes","kB","MB","GB","TB"];const s=Math.floor(Math.log(e)/Math.log(o));return`${Number.parseFloat((e/Math.pow(o,s)).toFixed(a))} ${r[s]}`};const i=':host,::slotted(*),*{box-sizing:border-box}:host([disabled]){cursor:not-allowed !important;}:host([disabled]) *,:host([disabled]) ::slotted(*){cursor:not-allowed !important;pointer-events:none !important;}button,.market-button,::slotted(button),::slotted(.market-button),::slotted(.market-link){font-weight:var(--core-type-semibold-30-weight);font-size:var(--core-type-semibold-30-size);font-family:var(--core-type-semibold-30-font-family);line-height:var(--core-type-semibold-30-leading);letter-spacing:var(--core-type-semibold-30-tracking);text-transform:var(--core-type-semibold-30-case)}.label-container{border-width:var(--file-upload-border-width, 1px);border-style:var(--file-upload-normal-state-border-style, dashed);border-color:var(--file-upload-normal-state-border-color, var(--core-fill-30-color));border-radius:var(--file-upload-border-radius, 6px);transition:background-color border-color 0.2s}.label-container>label{display:flex;flex-direction:column;justify-content:center;align-items:center;padding:var(--file-upload-dropzone-vertical-padding, var(--core-metrics-spacing-400))\n      var(--file-upload-dropzone-horizontal-padding, var(--core-metrics-spacing-400));text-align:center;cursor:pointer}.label-container>label .market-icon{color:var(--file-upload-label-fill-color, var(--core-text-10-color))}.label-container>.market-row{margin:0}button,.market-button,::slotted(button),::slotted(.market-button),::slotted(.market-link){padding:0}slot:not([name="compact"]) button,slot:not([name="compact"]) .market-button,slot:not([name="compact"]) ::slotted(button),slot:not([name="compact"]) ::slotted(.market-button),slot:not([name="compact"]) ::slotted(.market-link){border:none;background-color:inherit;color:var(--file-upload-button-label-color, var(--button-normal-variant-tertiary-rank-normal-state-label-color));font-family:inherit;text-align:right;cursor:pointer}.has-file-selected{border-style:var(--file-upload-file-selected-state-border-style, solid) !important;border-color:var(--file-upload-file-selected-state-border-color, var(--core-fill-30-color))}@media (hover: hover){:host(:hover) .label-container{border-style:var(--file-upload-hover-state-border-style, dashed);border-color:var(--file-upload-hover-state-border-color, var(--core-emphasis-fill-color));background-color:var(--file-upload-hover-state-background-color, var(--core-emphasis-40-color))}}:host(:active) .label-container,:host(:active) .is-dragging-over{border-style:var(--file-upload-active-state-border-style, dashed);border-color:var(--file-upload-active-state-border-color, var(--core-emphasis-fill-color));background-color:var(--file-upload-active-state-background-color, var(--core-emphasis-30-color))}:host([disabled]) .label-container{border-style:var(--file-upload-disabled-state-border-style, dashed);border-color:var(--file-upload-disabled-state-border-color, var(--field-disabled-state-border-color));background-color:var(--file-upload-disabled-state-background-color, var(--field-disabled-state-background-color));color:var(--file-upload-disabled-state-label-color, var(--field-disabled-state-empty-phase-label-color))}:host([disabled]) button,:host([disabled]) ::slotted(button),:host([disabled]) ::slotted(.market-button),:host([disabled]) ::slotted(.market-icon),:host([disabled]) ::slotted(.market-link),:host([disabled]) label .market-icon,:host([disabled]) label ::slotted(.market-icon){opacity:30%}slot[name="compact-action"]{display:none}:host([compact]) slot[name="compact-action"]{display:block;width:100%}:host([compact]) slot:not([name="compact-action"]){display:none}:host([compact]) .label-container{border-style:unset;border-color:unset;background-color:unset}:host([compact]) .label-container>label{padding:0}:host([compact]) .market-button,:host([compact]) .market-link,:host([compact]) ::slotted(.market-button),:host([compact]) ::slotted(.market-link){width:100%}.market-list{margin-top:var(--file-upload-dropzone-vertical-margin, var(--core-metrics-spacing-100))}.market-accessory[slot="leading-accessory"]{border-radius:var(--file-upload-border-radius, 6px);background-color:var(--file-upload-leading-accessory-background-color, var(--core-fill-40-color))}.market-accessory[slot="trailing-accessory"]{cursor:pointer}.market-accessory[slot="trailing-accessory"] .market-icon{color:var(--file-upload-delete-fill-color, var(--core-fill-20-color))}[data-status]:not([data-status=""]) .market-accessory[slot="leading-accessory"]{background-color:unset}[data-status="error"] [slot="subtext"],[data-status="error"] .market-accessory[slot="leading-accessory"]{color:var(--file-upload-leading-accessory-error-color, var(--core-critical-fill-color))}:host([disabled]) [data-status="error"] [slot="subtext"]{opacity:30%}[data-status="success"] .market-accessory[slot="leading-accessory"]{color:var(--file-upload-leading-accessory-success-color, var(--core-success-fill-color))}[data-status="loading"] .market-accessory[slot="leading-accessory"]{animation:market-file-upload-loading-rotation 1s infinite linear}@keyframes market-file-upload-loading-rotation{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}:host([invalid]) .label-container{border-color:var(--field-normal-state-invalid-validity-border-color)}::slotted([slot="bottom-accessory"]){color:var(--core-text-20-color)}';const c=i;const d=class{constructor(o){e(this,o);this.marketFileUploadValueChange=t(this,"marketFileUploadValueChange",7);this.accept="";this.value=[];this.disabled=false;this.invalid=false;this.multiple=false;this.compact=false;this.fileSubtext=undefined;this.fileMetadata=undefined;this.deleteButtonAriaLabel="Delete";this.isDraggingOver=false;this.files=undefined}watchValueHandler(e){if(Array.isArray(e)){this.files=this.multiple?[...e]:[e[0]]}}watchDisabledHandler(){this.slottedCompactButtons.forEach((e=>e.disabled=this.disabled))}get hasSingleFileSelected(){return!this.multiple&&this.files.length===1}get slottedCompactButtons(){const e=new Set([s("market-button"),s("market-link")]);return[...this.el.querySelector('[slot="compact-action"]').children].filter((t=>e.has(t.tagName.toLowerCase())))}draggingOver(e){if(this.disabled||this.hasSingleFileSelected){return}this.isDraggingOver=true;e.preventDefault()}endDrag(e){e.preventDefault();if(this.disabled||this.hasSingleFileSelected){return}this.isDraggingOver=false;if(e.type==="drop"&&e.dataTransfer){this.addFiles(e.dataTransfer.files)}}handleButtonClick(){this.fileInputElement.click()}handleDeleteKeydown(e,t){if(e.key==="Enter"&&!this.disabled){this.removeFile(t)}}removeFile(e){this.files.splice(e,1);this.files=[...this.files];this.emitFileChange()}labelContainerClassNames(){const e=[];if(this.isDraggingOver){e.push("is-dragging-over")}if(this.hasSingleFileSelected){e.push("has-file-selected")}return e}onInputChange(e){this.addFiles(e.target.files);this.fileInputElement.value=""}addFiles(e){if(e){if(!this.multiple){this.files=[e[0]]}else{this.files=[...e,...this.files]}}this.emitFileChange()}emitFileChange(){this.marketFileUploadValueChange.emit({value:this.files})}handleCompactSlotChange(){this.slottedCompactButtons.forEach((e=>{e.removeEventListener("click",this.handleButtonClick.bind(this));if(!this.disabled){e.addEventListener("click",this.handleButtonClick.bind(this))}e.disabled=this.disabled}))}componentWillLoad(){if(this.value){this.files=[...this.value]}else{this.files=[]}}componentDidLoad(){this.handleCompactSlotChange()}renderFilesAsMarketRows(){const e=s("market-row");const t=s("market-accessory");const a=s("market-icon");return this.files.map(((r,s)=>{var i;const c=(i=this.fileMetadata)===null||i===void 0?void 0:i.find((e=>e.filename===r.name));let d=r.type.startsWith("image/")?"picture":"file";let n="delete";let b;switch(this.fileSubtext){case"size":b=l(r[this.fileSubtext]);break;case"type":b=r[this.fileSubtext];break}switch(c===null||c===void 0?void 0:c.status){case"error":d="warning";n="clear";b=c===null||c===void 0?void 0:c.message;break;case"loading":d="loading";n="clear";break;case"success":d="success";break}d=(c===null||c===void 0?void 0:c.leadingIconName)||d;return o(e,{disabled:this.disabled,interactive:true,transient:true,"data-index":s,"data-status":c===null||c===void 0?void 0:c.status},o("label",{slot:"label"},r.name),b&&o("p",{slot:"subtext"},b),o(t,{slot:"leading-accessory",size:"image"},o(a,{name:d,fidelity:24})),o(t,{slot:"trailing-accessory",size:"icon",tabindex:this.disabled?-1:0,role:"button","aria-label":this.deleteButtonAriaLabel,onKeyDown:e=>this.handleDeleteKeydown(e,s),onClick:()=>this.removeFile(s)},o(a,{name:n,fidelity:24})))}))}render(){const e=s("market-list");const t=s("market-accessory");const r=s("market-icon");const l=s("market-field");const i=s("market-button");const c=this.renderFilesAsMarketRows();const d=this.multiple||c.length===0;const n=this.multiple&&c.length>0;return o(a,{key:"a6387bad3723b23579e4803bc809802dc05bbe80",class:"market-file-upload",ondragenter:e=>this.draggingOver(e),ondragover:e=>this.draggingOver(e),ondragleave:e=>this.endDrag(e),ondrop:e=>this.endDrag(e)},o(l,{key:"9ddf6b3ef0cc37b4fe171ffde6b1db2dc25a5880",disabled:this.disabled,invalid:this.invalid},o("div",{key:"5db42c4af01b94ee691e4bfc8c3695f4ff5cfde1",class:`label-container ${this.labelContainerClassNames()}`},!d&&c[0],d&&o("label",{key:"6a0554081de2392295a706c220aec4ff890c6581"},o("slot",{key:"f8dda6a2fc67c2d25b61ceca30eee030cbdace99"},o(t,{key:"01fa720e37c0e4e9a9d3c131c9724ebb0c67db66",size:"image"},o(r,{key:"3c00d32e418d48998a82b6659b0e712f02435e27",name:"file",fidelity:24})),o("span",{key:"fd67c239b8a5f91429b36053ece843bfff65c998"},o("button",{key:"85d595f5a16f5f59e879dadc361e7426d4160fc2",onClick:()=>this.handleButtonClick()},"Choose a file")," or drag and drop it here")),o("slot",{key:"c415fc3cc17a5387d4ec8b4353603ae2eb877221",name:"compact-action",onSlotchange:()=>this.handleCompactSlotChange()},o(i,{key:"98b94fc6b3a7438d88da13a2cc8cd073d33359c4",rank:"primary",disabled:this.disabled,onClick:()=>this.handleButtonClick()},"Upload file")),o("input",{key:"48c717f8ae9f8846fadf12ff4e0ee7522ba27e90",ref:e=>this.fileInputElement=e,onChange:e=>this.onInputChange(e),type:"file",name:"files[]",multiple:this.multiple,accept:this.accept,hidden:true}))),o("slot",{key:"e9d47e3973faf4525b19cbfcdd3d75ada36d4fc3",name:"bottom-accessory"},o("small",{key:"832c55e6dcc9502fb1684455726b9b38040c8311",slot:"bottom-accessory"})),o("slot",{key:"a11420e7a810512140165124aa659f8e952de3e9",name:"error"},o("small",{key:"3ac344c99721274c2493afeec18f42c224375a28",slot:"error"}))),n&&o(e,{key:"542ed5f8cabf72bcf2a61db1875d3b26c9b6373a",interactive:true,transient:true},c))}get el(){return r(this)}static get watchers(){return{value:["watchValueHandler"],disabled:["watchDisabledHandler"]}}};d.style=c;export{d as market_file_upload};
//# sourceMappingURL=p-fd3ec2d1.entry.js.map