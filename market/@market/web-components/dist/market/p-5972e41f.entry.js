import{r as t,h as e,H as s,g as i}from"./p-c9795ae2.js";import{g as o}from"./p-a7d431c5.js";import{t as a}from"./p-a6d610dc.js";import{b as r}from"./p-642ac27c.js";import"./p-632cbbe7.js";import"./p-c4e5a9dd.js";import"./p-a18d14d7.js";import"./p-4d83f578.js";import"./p-add0a9e5.js";import"./p-20bafc2c.js";function n(t,e){return r(t,e)}const l=t=>{const e=t.split(" ");const s=["auto-fill","auto-fit","minmax","fit-content"];const i=s.filter((e=>t.includes(e)));const o=`${i.length>0?"features":"feature"} ${i.map((t=>`\`${t}\``)).join(", ")}`;if(i.length>0){console.warn(`<market-table>'s grid layout is not built to support the use of the CSS ${o}.\nTo avoid potential column layout issues, try using explicitly defined \`grid-template-column\` widths using length, percentage, or flex units.`);return e}const a=[];let r=0;let n=null;for(r=0;r<e.length;r++){const t=e[r];if(t.includes("repeat(")){n=Number.parseInt(t.match(/\d+/).toString(),10);const s=e.findIndex(((t,e)=>e>r&&t.includes(")")));const i=e.slice(r+1,s+1).map((t=>t.replace(/\W/,"")));for(let t=0;t<n;t++){a.push(i[t%i.length].toString())}n=null;r+=i.length}else if(!n){a.push(t)}}return a};const h=':host{position:relative;display:grid;grid-auto-columns:1fr;grid-auto-flow:rows;overflow-x:clip;height:auto}::slotted(.market-table-row:last-of-type:not([slot="header"])),::slotted(.market-table-row.buffer-row){border-bottom:none !important;}';const c=h;const d=16;const b=class{constructor(e){t(this,e);this.observers={};this.throttledDetectStyleDeclaration=a(this.detectStyleDeclaration.bind(this),d);this.styleDeclaration=undefined;this.gridColumnTemplate=undefined;this.allColumns=[];this.visibleColumns=[];this.columnsStuckLeft=[];this.columnsStuckRight=[];this.columnsUnstuck=[];this.allRows=[];this.rowsStuckTop=[];this.rowsStuckBottom=[];this.rowsUnstuck=[];this.hasAccordionRows=false}styleDeclarationObserver(t,e){if(t!==e){if(t.getPropertyValue("grid-template-columns")===t.getPropertyValue("width")){this.gridColumnTemplate=[];return}const e=l(t.getPropertyValue("grid-template-columns"));if(!n(e,this.gridColumnTemplate)){this.gridColumnTemplate=e}}}gridTemplateObserver(t,e){if(t!==e){this.setColumnWidths(t);this.updateGridLayout()}}allColumnsObserver(t,e){if(t&&(!e||t!==e)){this.setColumnWidths(this.gridColumnTemplate);this.forwardColumnPropertiesToCells(this.allColumns);this.updateGridLayout()}}allRowsObserver(t,e){if(t!==e&&t){this.updateGridLayout();this.forwardColumnPropertiesToCells(this.allColumns);this.updateStickyRows()}}stuckRowsObserver(t,e){if(t!==e){this.allRows.map((t=>t.classList.remove("buffer-row")));if(this.rowsStuckTop.length>0){this.rowsStuckTop[this.rowsStuckTop.length-1].classList.add("buffer-row")}if(this.rowsUnstuck.length>0&&this.rowsStuckBottom.length>0){this.rowsUnstuck[this.rowsUnstuck.length-1].classList.add("buffer-row")}}}marketTableHeaderLoadedEventHandler({detail:t}){this.allColumns=[...t.columns];this.checkColumnVisibility()}marketTableRowStickEventHandler({target:t,detail:e}){switch(e.position){case"top":t.slot="sticky-header";break;case"bottom":t.slot="sticky-footer";break;default:console.warn("could not stick row to an unknown position");break}this.updateStickyRows()}marketTableRowUnstickEventHandler({target:t}){if(t.originalSlot){t.slot=t.originalSlot}else{t.removeAttribute("slot")}this.updateStickyRows()}async marketTableColumnStickEventHandler({target:t,detail:e}){await Promise.all([...this.allRows].map((async s=>{await s._stickColumn(t.name,e.position)})));this.updateGridLayout()}async marketTableColumnUnstickEventHandler({target:t}){await Promise.all([...this.allRows].map((async e=>{await e._unstickColumn(t.name)})));this.updateGridLayout()}marketTableColumnVisibilityChangeHandler({detail:t}){this.checkColumnVisibility();this.allRows.forEach((e=>e._syncColumnVisibilityWithCells(t.columnName,t.hidden)));this.detectStyleDeclaration()}checkColumnVisibility(){this.visibleColumns=this.allColumns.filter((t=>!t.hidden))}setColumnWidths(t){if(this.allColumns.length>0){this.visibleColumns.forEach(((e,s)=>{e.width=t[s]}))}}forwardColumnPropertiesToCells(t){this.allRows.forEach((e=>e.tableColumns=t))}updateGridLayout(){if(this.allColumns.length>0){this.columnsUnstuck=this.visibleColumns.filter((t=>!t.stickTo));this.columnsStuckLeft=this.visibleColumns.filter((t=>t.stickTo==="left"));this.columnsStuckRight=this.visibleColumns.filter((t=>t.stickTo==="right"));const t=this.columnsUnstuck.map((t=>t.width));const e=this.columnsStuckLeft.map((t=>t.width));const s=this.columnsStuckRight.map((t=>t.width));if(this.allRows.length>0){this.allRows.forEach((i=>{i.gridTemplateMain=t;i.gridTemplateLeft=e;i.gridTemplateRight=s}))}}}updateStickyRows(){this.rowsStuckTop=this.allRows.filter((t=>t.sticky&&t.header||t.stickTo==="top"));this.rowsStuckBottom=this.allRows.filter((t=>t.sticky&&t.footer||t.stickTo==="bottom"));this.rowsUnstuck=this.allRows.filter((t=>!t.stickTo&&!t.sticky))}handleSlotChange(){this.allRows=[...this.el.querySelectorAll(o("market-table-row"))];const t=[...this.el.children].some((t=>t.tagName.toLowerCase()===o("market-accordion-item")))||this.hasAccordionRows;this.allRows.forEach((e=>{e.index=Array.prototype.indexOf.call(this.allRows,e);e.nested=t}))}detectStyleDeclaration(){this.styleDeclaration=window.getComputedStyle(this.el)}initResizeObserver(){if(!this.observers.resize){this.observers.resize=new ResizeObserver((()=>{window.requestAnimationFrame((()=>{this.throttledDetectStyleDeclaration()}))}));this.observers.resize.observe(this.el)}}initInlineStyleObserver(){if(!this.observers.inlineStyle){this.observers.inlineStyle=new MutationObserver((()=>this.detectStyleDeclaration()));this.observers.inlineStyle.observe(this.el,{attributes:true,attributeFilter:["style"]})}}initContentObserver(){if(!this.observers.content){this.observers.content=new MutationObserver((()=>this.handleSlotChange()));this.observers.content.observe(this.el,{childList:true,subtree:true,characterData:true})}}componentWillLoad(){this.detectStyleDeclaration();this.handleSlotChange()}componentDidLoad(){this.initResizeObserver();this.initInlineStyleObserver();this.initContentObserver()}render(){const t=o("market-table-area");return e(s,{key:"750ac6164e83749b5758c5f20c91f6a6d988af91",class:"market-table",role:"table",onSlotchange:()=>this.handleSlotChange()},e(t,{key:"8bc1b426fbad9c7304f6bda63db8601b45f97b99",orientation:"horizontal","stick-to":"top",active:this.rowsStuckTop.length>0},e("slot",{key:"2ab3c201d6e338fbb397cc36cfc6fbc9d038bcb6",name:"sticky-header"})),e(t,{key:"07bfd6ecb2f17bb9e638c785f011da78f2b8862f",orientation:"horizontal",active:true},e("slot",{key:"ca54212375991cbac6de49408d2f96f2c48da7ba",name:"header"}),e("slot",{key:"e94324ff706ca1c4042012ff1023b987afdc6f22"}),e("slot",{key:"6cc3e5e907e99aae0da23475a78a0bde71b15a5f",name:"footer"})),e(t,{key:"7f7a445262d602d1663ce17a6045757fc0120707",orientation:"horizontal","stick-to":"bottom",active:this.rowsStuckBottom.length>0},e("slot",{key:"fcc44e81dccc24f0eebbd83847628a92179df269",name:"sticky-footer"})))}disconnectedCallback(){Object.values(this.observers).forEach((t=>{t===null||t===void 0?void 0:t.disconnect()}))}get el(){return i(this)}static get watchers(){return{styleDeclaration:["styleDeclarationObserver"],gridColumnTemplate:["gridTemplateObserver"],allColumns:["allColumnsObserver"],visibleColumns:["allColumnsObserver"],allRows:["allRowsObserver"],rowsStuckTop:["stuckRowsObserver"],rowsStuckBottom:["stuckRowsObserver"],rowsUnstuck:["stuckRowsObserver"]}}};b.style=c;export{b as market_table};
//# sourceMappingURL=p-5972e41f.entry.js.map