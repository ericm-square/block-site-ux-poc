{"version":3,"names":["marketButtonCss","MarketButtonStyle0","MarketButton","this","handleImplicitSubmission","type","form","el","closest","fakeButton","document","createElement","style","display","appendChild","click","remove","onMutationObserved","ariaAttributes","focusedChangeHandler","newValue","innerTag","focus","handleClick","event","disabled","isLoading","stopImmediatePropagation","setFocus","value","Promise","resolve","focused","blur","handleSlotChange","iconSlot","querySelector","hasIcon","Boolean","buttonText","textContent","trim","hasLabelText","iconText","length","iconOnly","componentWillLoad","mutationObserver","observeAriaAttributes","render","caret","href","innerTabindex","target","rel","download","TagType","undefined","TagTypeAttrs","MarketActivityIndicatorTagName","getNamespacedTagFor","MarketIconTagName","h","Host","key","class","onClick","Object","assign","tabindex","onFocus","onBlur","ref","name","onSlotchange","size","disconnectedCallback","_a","disconnect"],"sources":["src/components/market-button/styles/market-button.css?tag=market-button&encapsulation=shadow","src/components/market-button/market-button.tsx"],"sourcesContent":["@import \"./market-button-base.css\";\n@import \"./market-button-small.css\";\n@import \"./market-button-medium.css\";\n@import \"./market-button-large.css\";\n@import \"./market-button-primary.css\";\n@import \"./market-button-secondary.css\";\n@import \"./market-button-tertiary.css\";\n@import \"./market-button-destructive.css\";\n","import { Component, Prop, Element, Host, h, Listen, State, Method, Watch } from '@stencil/core';\n\nimport { observeAriaAttributes, AriaAttributes } from '../../utils/aria';\nimport { getNamespacedTagFor } from '../../utils/namespace';\n\n/**\n * @slot - The text used for the button label\n * @slot icon - an icon that is to the left of button text, or centered if there is no text\n */\n@Component({\n  tag: 'market-button',\n  shadow: true,\n  styleUrl: 'styles/market-button.css',\n})\nexport class MarketButton {\n  @Element() el: HTMLMarketButtonElement;\n\n  /**\n   * String for setting (optional) button caret direction\n   */\n  @Prop() readonly caret: 'up' | 'down' | 'none' = 'none';\n\n  /**\n   * Functionally and visually disables the button\n   */\n  @Prop({ reflect: true }) readonly disabled: boolean = false;\n\n  /**\n   * Causes the browser to treat the linked URL as a download. Only works for same-origin URLs.\n   * Only applies when an `href` is provided.\n   * See [here](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/a#attr-download) for details on accepted values.\n   */\n  @Prop() readonly download: string | undefined;\n\n  /**\n   * Whether or not the button is in a focused state\n   */\n  @Prop({ mutable: true, reflect: true }) focused: boolean = false;\n\n  /**\n   * Contains a URL or a URL fragment that the hyperlink points to.\n   * If this property is set, an anchor tag will be rendered.\n   */\n  @Prop() readonly href: string | undefined;\n\n  /**\n   * Whether the button only contains an icon.\n   */\n  @Prop({ mutable: true, reflect: true }) iconOnly: boolean = false;\n\n  /**\n   * Optionally set a custom tabindex on the inner HTML `<button>`.\n   */\n  @Prop() readonly innerTabindex: number;\n\n  /**\n   * Whether or not the button is in a loading state\n   */\n  @Prop({ reflect: true }) readonly isLoading: boolean = false;\n\n  /**\n   * String for setting button rank\n   */\n  @Prop({ reflect: true }) readonly rank: 'primary' | 'secondary' | 'tertiary' = 'secondary';\n\n  /**\n   * Defines the relationship between a linked resource and the current document.\n   * Only applies when an `href` is provided.\n   * See [here](https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes/rel) for details on accepted values.\n   */\n  @Prop() readonly rel: string | undefined;\n\n  /**\n   * String for setting button size\n   */\n  @Prop({ reflect: true }) readonly size: 'small' | 'medium' | 'large' = 'medium';\n\n  /**\n   * Specifies where to display the linked URL.\n   * Only applies when an `href` is provided.\n   * See [here](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/a#attr-target) for details on accepted values.\n   */\n  @Prop() readonly target: '_blank' | '_self' | '_parent' | '_top' | undefined;\n\n  /**\n   * String for setting button type\n   */\n  @Prop({ reflect: true }) readonly type: 'button' | 'reset' | 'submit' = 'button';\n\n  /**\n   * String for setting button variant\n   */\n  @Prop({ reflect: true }) readonly variant: 'regular' | 'destructive' = 'regular';\n\n  @State() ariaAttributes: AriaAttributes;\n\n  innerTag: HTMLElement;\n\n  mutationObserver: MutationObserver;\n\n  @Watch('focused')\n  focusedChangeHandler(newValue: boolean) {\n    if (!this.innerTag) {\n      return;\n    }\n    if (newValue) {\n      this.innerTag.focus();\n    }\n  }\n\n  /* Listening for click events here allows us to stop bubbling when\n  disabled. Attaching listeners to Host (as the Stencil linter prefers),\n  seems to also work in Stencil tests, but fails in Ember for some reason.\n  We listen in the \"capture\" phase to ensure we're hit before any external\n  click handlers. See here for details:\n  https://www.sitepoint.com/event-bubbling-javascript/ */\n  @Listen('click', { capture: true })\n  handleClick(event: UIEvent) {\n    if (this.disabled || this.isLoading) {\n      // Calling `stopImmediatePropagation` instead of `stopPropagation`\n      // allows us to block current and future \"sibling\" event listeners\n      // that have also been attached to this element, as opposed to just\n      // those higher in the DOM tree.\n      event.stopImmediatePropagation();\n    }\n  }\n\n  /**\n   * Sets `focused` state, except when disabled. Allows external consumers to programmatically\n   * trigger focused styling.\n   */\n  @Method()\n  setFocus(value: boolean = true) {\n    if (this.disabled) {\n      return Promise.resolve();\n    }\n    this.focused = value; // this will cause the `focusedChangeHandler` to be triggered\n    if (!value && this.innerTag) {\n      this.innerTag.blur();\n    }\n    return Promise.resolve();\n  }\n\n  // Implicit submission is when an interaction within a form fires a click event on the form's first submit button in tree order.\n  // Because the inner <button> of <market-button> is in the shadow dom and not in tree order, we lose this functionality.\n  // To ensure we have the exact behavior that a plain button would have had in this situation,\n  // we add a hidden button to the form and click it for the implicit submission.\n  // https://www.hjorthhansen.dev/shadow-dom-and-forms/\n\n  // note: this is attached in the host element's onclick instead of with the @Listen decorator\n  // to ensure the following fire in the correct order:\n  // 1) handleClick\n  // 2) the event passed to market-button\n  // 3) implicit submission\n  // In Ember, the @Listen would fire before the event passed to the button, which could result in the event not happening.\n  handleImplicitSubmission = () => {\n    if (this.type === 'submit') {\n      const form = this.el.closest('form');\n      if (form) {\n        const fakeButton = document.createElement('button');\n        fakeButton.type = this.type;\n        fakeButton.style.display = 'none';\n        form.appendChild(fakeButton);\n        fakeButton.click();\n        fakeButton.remove();\n      }\n    }\n  };\n\n  onMutationObserved = (ariaAttributes: AriaAttributes) => {\n    this.ariaAttributes = ariaAttributes;\n  };\n\n  handleSlotChange() {\n    const iconSlot = this.el.querySelector('[slot=\"icon\"]');\n    const hasIcon = Boolean(iconSlot);\n    const buttonText = this.el.textContent.trim();\n\n    let hasLabelText: boolean;\n    if (hasIcon) {\n      // Check for text in the icon itself, such as icon badge text. This text is considered part of the icon and not a label.\n      // Since buttonText contains all text in the element including the svg, only set hasLabelText to true if text exists outside of the icon.\n      const iconText = iconSlot.textContent.trim();\n      hasLabelText = buttonText.length > iconText.length;\n    } else {\n      hasLabelText = buttonText.length > 0;\n    }\n\n    this.iconOnly = hasIcon && !hasLabelText;\n  }\n\n  componentWillLoad() {\n    this.mutationObserver = observeAriaAttributes(this.el, this.onMutationObserved);\n    this.handleSlotChange();\n  }\n\n  render() {\n    const {\n      // props\n      caret,\n      disabled,\n      href,\n      innerTabindex,\n      isLoading,\n      target,\n      type,\n      rel,\n      download,\n\n      // state\n      ariaAttributes,\n\n      // methods\n      handleImplicitSubmission,\n    } = this;\n    const TagType: string = href === undefined ? 'button' : 'a';\n    const TagTypeAttrs = TagType === 'button' ? { type, disabled } : { href, target, rel, download };\n    const MarketActivityIndicatorTagName = getNamespacedTagFor('market-activity-indicator');\n    const MarketIconTagName = getNamespacedTagFor('market-icon');\n\n    return (\n      <Host class=\"market-button\" onClick={handleImplicitSubmission}>\n        <TagType\n          class=\"inner-tag\"\n          {...TagTypeAttrs}\n          {...ariaAttributes}\n          tabindex={disabled ? -1 : innerTabindex}\n          onFocus={() => {\n            this.focused = true;\n          }}\n          onBlur={() => {\n            this.focused = false;\n          }}\n          ref={(el) => (this.innerTag = el)}\n        >\n          <slot name=\"icon\" onSlotchange={() => this.handleSlotChange()}></slot>\n          <slot onSlotchange={() => this.handleSlotChange()}></slot>\n          {caret === 'down' && <MarketIconTagName name=\"expand\"></MarketIconTagName>}\n          {caret === 'up' && <MarketIconTagName name=\"collapse\"></MarketIconTagName>}\n        </TagType>\n        {isLoading && <MarketActivityIndicatorTagName size=\"small\"></MarketActivityIndicatorTagName>}\n      </Host>\n    );\n  }\n\n  disconnectedCallback() {\n    this.mutationObserver?.disconnect();\n  }\n}\n"],"mappings":"4HAAA,MAAMA,EAAkB,y+aACxB,MAAAC,EAAeD,E,MCaFE,EAAY,M,yBA6IvBC,KAAAC,yBAA2B,KACzB,GAAID,KAAKE,OAAS,SAAU,CAC1B,MAAMC,EAAOH,KAAKI,GAAGC,QAAQ,QAC7B,GAAIF,EAAM,CACR,MAAMG,EAAaC,SAASC,cAAc,UAC1CF,EAAWJ,KAAOF,KAAKE,KACvBI,EAAWG,MAAMC,QAAU,OAC3BP,EAAKQ,YAAYL,GACjBA,EAAWM,QACXN,EAAWO,Q,IAKjBb,KAAAc,mBAAsBC,IACpBf,KAAKe,eAAiBA,CAAc,E,WAtJW,O,cAKK,M,qCAYK,M,kCAWC,M,4CAUL,M,UAKwB,Y,6BAYR,S,gCAYC,S,aAKD,U,8BASvE,oBAAAC,CAAqBC,GACnB,IAAKjB,KAAKkB,SAAU,CAClB,M,CAEF,GAAID,EAAU,CACZjB,KAAKkB,SAASC,O,EAWlB,WAAAC,CAAYC,GACV,GAAIrB,KAAKsB,UAAYtB,KAAKuB,UAAW,CAKnCF,EAAMG,0B,EASV,QAAAC,CAASC,EAAiB,MACxB,GAAI1B,KAAKsB,SAAU,CACjB,OAAOK,QAAQC,S,CAEjB5B,KAAK6B,QAAUH,EACf,IAAKA,GAAS1B,KAAKkB,SAAU,CAC3BlB,KAAKkB,SAASY,M,CAEhB,OAAOH,QAAQC,S,CAiCjB,gBAAAG,GACE,MAAMC,EAAWhC,KAAKI,GAAG6B,cAAc,iBACvC,MAAMC,EAAUC,QAAQH,GACxB,MAAMI,EAAapC,KAAKI,GAAGiC,YAAYC,OAEvC,IAAIC,EACJ,GAAIL,EAAS,CAGX,MAAMM,EAAWR,EAASK,YAAYC,OACtCC,EAAeH,EAAWK,OAASD,EAASC,M,KACvC,CACLF,EAAeH,EAAWK,OAAS,C,CAGrCzC,KAAK0C,SAAWR,IAAYK,C,CAG9B,iBAAAI,GACE3C,KAAK4C,iBAAmBC,EAAsB7C,KAAKI,GAAIJ,KAAKc,oBAC5Dd,KAAK+B,kB,CAGP,MAAAe,GACE,MAAMC,MAEJA,EAAKzB,SACLA,EAAQ0B,KACRA,EAAIC,cACJA,EAAa1B,UACbA,EAAS2B,OACTA,EAAMhD,KACNA,EAAIiD,IACJA,EAAGC,SACHA,EAAQrC,eAGRA,EAAcd,yBAGdA,GACED,KACJ,MAAMqD,EAAkBL,IAASM,UAAY,SAAW,IACxD,MAAMC,EAAeF,IAAY,SAAW,CAAEnD,OAAMoB,YAAa,CAAE0B,OAAME,SAAQC,MAAKC,YACtF,MAAMI,EAAiCC,EAAoB,6BAC3D,MAAMC,EAAoBD,EAAoB,eAE9C,OACEE,EAACC,EAAI,CAAAC,IAAA,2CAACC,MAAM,gBAAgBC,QAAS9D,GACnC0D,EAACN,EAAOW,OAAAC,OAAA,CAAAJ,IAAA,2CACNC,MAAM,aACFP,EACAxC,EAAc,CAClBmD,SAAU5C,GAAY,EAAI2B,EAC1BkB,QAAS,KACPnE,KAAK6B,QAAU,IAAI,EAErBuC,OAAQ,KACNpE,KAAK6B,QAAU,KAAK,EAEtBwC,IAAMjE,GAAQJ,KAAKkB,SAAWd,IAE9BuD,EAAA,QAAAE,IAAA,2CAAMS,KAAK,OAAOC,aAAc,IAAMvE,KAAK+B,qBAC3C4B,EAAA,QAAAE,IAAA,2CAAMU,aAAc,IAAMvE,KAAK+B,qBAC9BgB,IAAU,QAAUY,EAACD,EAAiB,CAAAG,IAAA,2CAACS,KAAK,WAC5CvB,IAAU,MAAQY,EAACD,EAAiB,CAAAG,IAAA,2CAACS,KAAK,cAE5C/C,GAAaoC,EAACH,EAA8B,CAAAK,IAAA,2CAACW,KAAK,U,CAKzD,oBAAAC,G,OACEC,EAAA1E,KAAK4C,oBAAgB,MAAA8B,SAAA,SAAAA,EAAEC,Y"}