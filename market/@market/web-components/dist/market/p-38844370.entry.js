import{r as t,c as e,h as i,H as o,g as a}from"./p-c9795ae2.js";import{c as s}from"./p-52c3ceb3.js";import{i as n,g as r}from"./p-1a71929d.js";import{c as d}from"./p-850c2440.js";import{a as h,t as c}from"./p-a6d610dc.js";import{i as l}from"./p-ba705441.js";import{s as m,o as p}from"./p-9ed4729e.js";import"./p-632cbbe7.js";import"./p-c4e5a9dd.js";import"./p-4d83f578.js";function u(t,e){return m(p(t,e,l),t+"")}var f="Expected a function";function g(t,e,i){if(typeof t!="function"){throw new TypeError(f)}return setTimeout((function(){t.apply(undefined,i)}),e)}var v=u((function(t,e,i){return g(t,h(e)||0,i)}));const b=v;const w={threshold:0,linearRatio:1,quadraticRatio:1,invert:false};function y(t,e={}){const{quadraticRatio:i,linearRatio:o,threshold:a,invert:s}=Object.assign({},w,e);const n=s?-1:1;if(t*n<a*n){return t}const r=(t-a)*n;let d=(r+1)**i-1;d=d*o;return a+d*n}function k(t,e,i){return t+i*(e-t)}function x(t,e){return{x:e.x-t.x,y:e.y-t.y}}function D(t){return(t.x**2+t.y**2)**.5}const z='@keyframes market-popup{from{opacity:0%;transform:scale(0.9, 0.9)}to{opacity:100%;transform:scale(1, 1)}}@keyframes market-popdown{from{opacity:100%;transform:scale(1, 1)}to{opacity:0%;transform:scale(0.9, 0.9)}}@keyframes market-slideup{from{opacity:0%;transform:translateY(80vh)}to{opacity:100%;transform:translateY(0)}}@keyframes market-slidedown{from{opacity:100%;transform:translateY(0)}to{opacity:0%;transform:translateY(80vh)}}@keyframes market-slide-left-enter{from{transform:translateX(100%)}to{transform:translateX(0)}}@keyframes market-slide-left-exit{from{transform:translateX(0)}to{transform:translateX(100%)}}@keyframes market-fade-in{from{opacity:0%}to{opacity:100%}}@keyframes market-fade-out{from{opacity:100%}to{opacity:0%}}@keyframes market-input-autofill-start{from{}to{}}@keyframes market-input-autofill-cancel{from{}to{}}@keyframes market-input-search-compact-enter{from{}to{}}@keyframes market-input-search-compact-exit{from{}to{}}:host{display:flex;flex-direction:column;justify-content:stretch;overflow:hidden}:host ::slotted(main),:host ::slotted(.main){flex:0 1 100%;overflow-y:auto;height:100%}:host ::slotted(.market-header){margin-bottom:var(--core-metrics-spacing-300);padding-top:0}:host ::slotted(.market-footer){padding-bottom:0}:host{--handle-whitespace:calc(var(--modal-sheet-handle-padding-top-size) + var(--modal-sheet-handle-padding-bottom-size));--handle-area-height:calc(var(--handle-whitespace) + var(--modal-sheet-handle-height));--max-width-padding:var(--modal-sheet-regular-horizontal-size-class-horizontal-padding);--min-width-padding:var(--modal-sheet-compact-horizontal-size-class-horizontal-padding);--padding-width:clamp(var(--min-width-padding), calc(50% - 200px), var(--max-width-padding));--padding-height:var(--modal-sheet-regular-vertical-size-class-vertical-padding);position:fixed;top:calc(100vh + var(--handle-area-height));bottom:auto;left:50%;overflow:visible;box-sizing:border-box;width:100%;max-width:calc(400px + calc(var(--max-width-padding) + var(--max-width-padding)));max-height:calc(100% - var(--handle-area-height));padding-top:var(--padding-height);border-radius:var(--modal-sheet-border-radius) var(--modal-sheet-border-radius) 0 0;background-color:var(--modal-sheet-background-color);opacity:0%;-webkit-user-select:none;-moz-user-select:none;user-select:none;transition:top var(--core-animation-enter-transition-moderate-speed-duration),\n    opacity var(--core-animation-enter-transition-moderate-speed-duration);transform:translate(-50%, 0)}:host([state="closed"]){top:calc(100vh + var(--handle-area-height));opacity:0%;transition:top var(--core-animation-exit-transition-moderate-speed-duration),\n      opacity var(--core-animation-exit-transition-moderate-speed-duration)}:host([state="partial-open"]){opacity:100%}:host([state="full-open"]){opacity:100%}:host([dragging]){transition:opacity var(--core-animation-enter-transition-moderate-speed-duration)}:host([tapdisabled]){pointer-events:none}:host ::slotted([slot="header"]){padding-right:var(--padding-width);padding-left:var(--padding-width)}:host::after{content:"";position:absolute;top:100%;display:block;width:inherit;max-width:inherit;height:100vh;background-color:inherit}.handle{position:fixed;bottom:calc(100% + var(--modal-sheet-handle-padding-bottom-size));left:50%;display:block;width:var(--modal-sheet-handle-width);height:var(--modal-sheet-handle-height);border:none;border-radius:var(--modal-sheet-border-radius);background-color:var(--modal-sheet-handle-background-color);-webkit-user-select:none;-moz-user-select:none;user-select:none;transform:translate(-50%, 0)}.handle::before{content:"";position:absolute;inset:calc(var(--modal-sheet-handle-padding-bottom-size) * -1)}.handle:focus{outline:var(--button-focus-ring-border-size) solid var(--button-focus-ring-color)}.main{overflow-x:hidden;overflow-y:auto;padding-right:var(--padding-width);padding-bottom:var(--padding-height);padding-left:var(--padding-width);overscroll-behavior:contain}.main[dragging]{overflow-y:hidden}';const j=z;const T=s.MODAL_SHEET_HANDLE_HEIGHT+s.MODAL_SHEET_HANDLE_PADDING_BOTTOM_SIZE+s.MODAL_SHEET_HANDLE_PADDING_TOP_SIZE;const O=.12;const S=250;const C=.01;const E=.8;const R=.55;const M=16;const $=class{constructor(i){t(this,i);this.marketDialogLoaded=e(this,"marketDialogLoaded",7);this.marketDialogDismissed=e(this,"marketDialogDismissed",7);this.marketDialogDidDismiss=e(this,"marketDialogDidDismiss",7);this.type="sheet";this.boundOnDragMove=this.onDragMove.bind(this);this.boundOnDragEnd=this.onDragEnd.bind(this);this.boundOnScrollDrag=this.onScrollDrag.bind(this);this.hidden=false;this.dialogID=undefined;this.openMode="partial";this.animationEnterDuration=s.CORE_ANIMATION_ENTER_TRANSITION_MODERATE_SPEED_DURATION;this.animationExitDuration=s.CORE_ANIMATION_EXIT_TRANSITION_MODERATE_SPEED_DURATION;this.disableFocus=false;this.closeHandleAriaLabel="Close"}async activateFocusTrap(t,e){if(this.focusTrap){this.focusTrap.activate(e);if(this.disableFocus){this.disableFocus=false}}else{this.focusTrap=d({activateOptions:e,el:this.el,options:Object.assign(Object.assign({},t),{initialFocus:false})})}this.focusTrapActivateOptions=e}async deactivateFocusTrap(t){if(this.focusTrap){this.focusTrap.deactivate(t);this.focusTrap=undefined}}async dismiss(t){const{defaultPrevented:e}=this.marketDialogDismissed.emit({dialog:this.el,type:this.type,origin:(t===null||t===void 0?void 0:t.origin)||this.el});if(!e){this.hidden=true;await new Promise((t=>setTimeout(t,s.CORE_ANIMATION_EXIT_TRANSITION_MODERATE_SPEED_DURATION)));this.marketDialogDidDismiss.emit({dialog:this.el,type:this.type,origin:this.el})}}setState(t){let e=t;if(e!=="closed"&&this.openMode!=="dynamic"){e=`${this.openMode}-open`}this.el.setAttribute("state",e);this.resetTopByState()}resetTopByState(){this.calculateTopBoundary();const t=this.el.getAttribute("state");const e=this.el.clientHeight;if(t==="closed"){this.el.style.removeProperty("top")}else if(e+T>=window.innerHeight||t==="full-open"){this.el.style.top=`${T+window.visualViewport.offsetTop}px`}else{this.el.style.top=`calc(100% - ${e}px)`}this.el.style.paddingBottom=window.visualViewport.offsetTop?`${window.visualViewport.offsetTop}px`:"0"}calculateTopBoundary(){this.topBoundary=this.openMode==="partial"?window.innerHeight-this.el.clientHeight:T;this.compressionRatio=k(R,E,this.topBoundary/window.innerHeight)}setTop(t){const e=y(t,{threshold:this.topBoundary,quadraticRatio:this.compressionRatio,invert:true});this.el.style.top=`${e}px`;return e}onDragStart(t){if(!n(t)&&t.button!==0){return}if(window.visualViewport.offsetTop){if(t.target===document.activeElement){return}document.activeElement.blur();t.target.click();return}const{top:e}=this.el.getBoundingClientRect();this.dragStartTop=e;this.el.setAttribute("dragging","");this.calculateTopBoundary();const i=this.setTop(e);const o=r(t);this.dragEventStack=[[t.timeStamp,i]];this.touchStartCoords=o;this.dragDelta={x:0,y:0};const{boundOnDragMove:a,boundOnDragEnd:s}=this;document.addEventListener("mousemove",a);document.addEventListener("mouseup",s);document.addEventListener("touchmove",a);document.addEventListener("touchend",s)}onDragMove(t){const e=r(t);this.dragDelta=x(this.touchStartCoords,e);if(!this.el.hasAttribute("tapdisabled")&&D(this.dragDelta)/window.innerHeight>C){this.el.setAttribute("tapdisabled","")}const i=this.setTop(this.dragStartTop+this.dragDelta.y);this.dragEventStack.push([t.timeStamp,i]);this.pruneStack(t.timeStamp)}onDragEnd(t){const e=r(t);this.dragDelta=x(this.touchStartCoords,e);const i=this.dragStartTop+this.dragDelta.y;const o=this.setTop(i);const a=this.openMode==="full"?T:window.innerHeight-this.el.clientHeight;const s=window.innerHeight/2;const n=k(window.innerHeight,a,.6);const d=k(T,a,.6);const h=O*window.innerHeight;this.dragEventStack.push([t.timeStamp,o]);const c=this.getGestureDelta(t,h);if(c>h){this.dismiss()}else if(c<-h){this.setState("full-open")}else if(i>s&&i>n){this.dismiss()}else if(i<d){this.setState("full-open")}else{this.setState("partial-open")}this.cleanupDragging()}onScrollStart(){this.scrollStart=this.mainContent.scrollTop;document.addEventListener("touchmove",this.boundOnScrollDrag,{passive:true})}onScrollDrag(t){const e=this.mainContent.scrollHeight-this.mainContent.clientHeight;const i=r(t);const o=x(this.touchStartCoords,i);const a=this.scrollStart-o.y;const{boundOnScrollDrag:s,mainContent:n}=this;if(a>=0&&a<=e){t.stopImmediatePropagation();this.cleanupDragging()}else{n.setAttribute("dragging","")}document.removeEventListener("touchmove",s)}pruneStack(t){while(this.dragEventStack.length>0&&this.dragEventStack[0][0]<t-S){this.dragEventStack.shift()}}getGestureDelta(t,e){let i=0;let o=this.dragEventStack.pop()[1];this.pruneStack(t.timeStamp);while(this.dragEventStack.length>0){const t=this.dragEventStack.pop()[1];const a=o-t;i+=a;o=t;if(Math.abs(i)>e)break}return i}cleanupDragging(){const{boundOnDragMove:t,boundOnDragEnd:e,el:i,mainContent:o}=this;i.removeAttribute("dragging");o.removeAttribute("dragging");i.removeAttribute("tapdisabled");document.removeEventListener("mousemove",t);document.removeEventListener("mouseup",e);document.removeEventListener("touchmove",t);document.removeEventListener("touchend",e)}onKeyDown(t){switch(t.key){case"Enter":this.dismiss();break;case" ":this.dismiss(t);t.preventDefault();break}}connectedCallback(){setTimeout((()=>{this.marketDialogLoaded.emit({dialog:this.el,type:this.type});if(!this.disableFocus){this.activateFocusTrap()}}),this.hidden?0:s.CORE_ANIMATION_ENTER_TRANSITION_MODERATE_SPEED_DURATION)}hiddenHandler(){this.setState(this.hidden?"closed":"partial-open")}componentDidLoad(){this.hiddenHandler();this.heightObserver=new ResizeObserver(c((()=>{this.resetTopByState()}),M));this.heightObserver.observe(this.el);window.visualViewport.addEventListener("resize",c((()=>{this.resetTopByState()}),M));this.mainContent.addEventListener("focusin",(t=>{this.resetTopByState();b((()=>{var e,i;if(window.visualViewport.offsetTop){const o=(e=t.relatedTarget)===null||e===void 0?void 0:e.offsetTop;const a=(i=document.activeElement)===null||i===void 0?void 0:i.offsetTop;document.activeElement.scrollIntoView({behavior:"smooth",block:o<a?"start":"center",inline:"start"})}}),250)}))}disconnectedCallback(){var t;(t=this.heightObserver)===null||t===void 0?void 0:t.disconnect()}render(){return i(o,{key:"0141e61e23a2b16ef9768c130296e7664c99ddcd",role:"dialog",onMouseDown:t=>this.onDragStart(t),onTouchStart:t=>this.onDragStart(t)},i("button",{key:"08b465eb785a4f2055d448f3db5b062228458f40","aria-label":this.closeHandleAriaLabel,class:"handle",onClick:this.dismiss.bind(this),onKeyDown:this.onKeyDown.bind(this)}),i("slot",{key:"7d87505923bbd66b5c0ee95c4c8f79f544fda8f6",name:"header"}),i("div",{key:"c643d8f2e58a18035ca76cbc034bd50922114fe9",class:"main",ref:t=>this.mainContent=t,onTouchStart:()=>this.onScrollStart()},i("slot",{key:"ce2087b1d85f22c5b2edc78b8f6cf9dd687a54e3"})))}get el(){return a(this)}static get watchers(){return{hidden:["hiddenHandler"]}}};$.style=j;export{$ as market_sheet};
//# sourceMappingURL=p-38844370.entry.js.map