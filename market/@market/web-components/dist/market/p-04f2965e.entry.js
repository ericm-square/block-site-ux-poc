import{r as t,c as e,h as i,H as s,g as r}from"./p-c9795ae2.js";import{g as n}from"./p-a7d431c5.js";import{a as o}from"./p-e5f35127.js";import{R as a}from"./p-4628ce60.js";import{i as l}from"./p-6ae1bfc9.js";import{i as h,g as c,L as d,a as u}from"./p-50a22327.js";import{S as f,b as v,k as m,s as b,a as p,c as w}from"./p-642ac27c.js";import{i as k}from"./p-632cbbe7.js";import{b as S,i as g,t as y,h as C}from"./p-34614423.js";import{i as D}from"./p-ba705441.js";import{i as I}from"./p-add0a9e5.js";import{S as x}from"./p-20bafc2c.js";import"./p-8e7315f7.js";import"./p-a18d14d7.js";import"./p-4d83f578.js";import"./p-c4e5a9dd.js";function j(){}function R(t,e,i,s){var r=t.length,n=i+(s?1:-1);while(s?n--:++n<r){if(e(t[n],n,t)){return n}}return-1}function V(t){return t!==t}function L(t,e,i){var s=i-1,r=t.length;while(++s<r){if(t[s]===e){return s}}return-1}function E(t,e,i){return e===e?L(t,e,i):R(t,V,i)}function M(t,e){var i=t==null?0:t.length;return!!i&&E(t,e,0)>-1}function A(t,e,i){var s=t==null?undefined:S(t,e);return s===undefined?i:s}var H=1,W=2;function F(t,e,i,s){var r=i.length,n=r,o=!s;if(t==null){return!n}t=Object(t);while(r--){var a=i[r];if(o&&a[2]?a[1]!==t[a[0]]:!(a[0]in t)){return false}}while(++r<n){a=i[r];var l=a[0],h=t[l],c=a[1];if(o&&a[2]){if(h===undefined&&!(l in t)){return false}}else{var d=new f;if(s){var u=s(h,c,l,t,e,d)}if(!(u===undefined?v(c,h,H|W,s,d):u)){return false}}}return true}function Z(t){return t===t&&!k(t)}function $(t){var e=m(t),i=e.length;while(i--){var s=e[i],r=t[s];e[i]=[s,r,Z(r)]}return e}function O(t,e){return function(i){if(i==null){return false}return i[t]===e&&(e!==undefined||t in Object(i))}}function P(t){var e=$(t);if(e.length==1&&e[0][2]){return O(e[0][0],e[0][1])}return function(i){return i===t||F(i,t,e)}}var q=1,B=2;function K(t,e){if(g(t)&&Z(e)){return O(y(t),e)}return function(i){var s=A(i,t);return s===undefined&&s===e?C(i,t):v(e,s,q|B)}}function U(t){return function(e){return e==null?undefined:e[t]}}function z(t){return function(e){return S(e,t)}}function N(t){return g(t)?U(y(t)):z(t)}function T(t){if(typeof t=="function"){return t}if(t==null){return D}if(typeof t=="object"){return I(t)?K(t[0],t[1]):P(t)}return N(t)}function _(t,e,i){var s=-1,r=t==null?0:t.length;while(++s<r){if(i(e,t[s])){return true}}return false}var G=1/0;var J=!(x&&1/b(new x([,-0]))[1]==G)?j:function(t){return new x(t)};const Q=J;var X=200;function Y(t,e,i){var s=-1,r=M,n=t.length,o=true,a=[],l=a;if(i){o=false;r=_}else if(n>=X){var h=e?null:Q(t);if(h){return b(h)}o=false;r=w;l=new p}else{l=e?[]:a}t:while(++s<n){var c=t[s],d=e?e(c):c;c=i||c!==0?c:0;if(o&&d===d){var u=l.length;while(u--){if(l[u]===d){continue t}}if(e){l.push(d)}a.push(c)}else if(!r(l,d,i)){if(l!==a){l.push(d)}a.push(c)}}return a}function tt(t,e){return t&&t.length?Y(t,T(e)):[]}const et=":host,::slotted(*),*{box-sizing:border-box}:host([disabled]){cursor:not-allowed !important;}:host([disabled]) *,:host([disabled]) ::slotted(*){cursor:not-allowed !important;pointer-events:none !important;}:host{display:block}::slotted(.market-action-card){margin-bottom:var(--action-card-spacing)}::slotted(.market-input-search){margin-bottom:var(--core-metrics-spacing-100)}.hidden,::slotted(.hidden){display:none}::slotted(.market-row.hide-bottom-border)::before{display:none}.market-empty-state,::slotted(.market-empty-state){padding-right:0;padding-left:0;border:0}::slotted(.market-drag-cursor){--drag-cursor-height:4px;display:block;height:0;outline:calc(var(--drag-cursor-height) / 2) solid var(--core-emphasis-fill-color);pointer-events:none}";const it=et;const st=class{constructor(i){t(this,i);this.marketListSelectionsDidChange=e(this,"marketListSelectionsDidChange",7);this.marketListSlotChange=e(this,"marketListSlotChange",7);this.marketListItemsReordered=e(this,"marketListItemsReordered",3);this.marketListItemsFiltered=e(this,"marketListItemsFiltered",7);this.observers={};this.value="";this.interactive=false;this.transient=false;this.multiselect=false;this.name=undefined;this.filterStrategy="textcontent";this.reorderable="off";this.reorderMode="default";this.hideSelectableCount=false;this.hasSearch=false;this.items=undefined;this.selections=new Set;this.filteredItems=undefined}reorderableWatcher(){this.setReorderable()}valueWatcher(){this.setSelectionsFromValue()}hideSelectableCountWatcher(){this.injectCountOnControlRow()}rowSelectedEventHandler(t){this.handleItemSelectedEvent(t.target)}rowDeselectedEventHandler(t){this.handleItemDeselectedEvent(t.target)}cardSelectedEventHandler(t){this.handleItemSelectedEvent(t.target)}cardDeselectedEventHandler(t){this.handleItemDeselectedEvent(t.target)}marketInputSearchValueChangeEventHander({detail:t}){this.filterItems(t.value)}getEventSelectionDetails(){const t=(()=>{if(typeof this.value==="string"){return this.value?this.value.split(",").filter((t=>!h(t))):[]}else if(Array.isArray(this.value)){return this.value.filter((t=>!h(t)))}return this.value})();const e=tt([...this.selections].filter((t=>t!==this.controlRow)),(t=>t.value));const i=e.reduce(((t,e)=>{if(!h(e.value)){t.push(e.value)}return t}),[]);return{currentSelections:e,currentSelectionValues:i,prevSelectionValues:t}}handleItemSelectedEvent(t){if(t===this.controlRow){this.selectAllItems()}else{this.selectItem(t)}const{currentSelections:e,currentSelectionValues:i,prevSelectionValues:s}=this.getEventSelectionDetails();this.value=i.join(",");this.marketListSelectionsDidChange.emit({newSelection:t,newSelectionValue:t.value,newDeselection:null,newDeselectionValue:null,currentSelections:e,currentSelectionValues:i,prevSelectionValues:s})}handleItemDeselectedEvent(t){if(!this.selections.has(t)){return}if(t===this.controlRow){const t=(()=>{var t,e;const i=((e=(t=this.filteredItems)===null||t===void 0?void 0:t.visible)!==null&&e!==void 0?e:this.items).filter((t=>t!==this.controlRow));const s=i.filter((t=>!t.disabled));return s.every((t=>!t.selected))})();if(t){this.selectAllItems()}else{this.deselectAllItems()}}else{this.deselectItem(t)}const{currentSelections:e,currentSelectionValues:i,prevSelectionValues:s}=this.getEventSelectionDetails();this.value=i.join(",");this.marketListSelectionsDidChange.emit({newSelection:null,newSelectionValue:null,newDeselection:t,newDeselectionValue:t.value,currentSelections:e,currentSelectionValues:i,prevSelectionValues:s})}selectItem(t){if(this.interactive){if(!this.multiselect){this.deselectItems([t]);this.selections=new Set([t])}else{this.selections.add(t)}}}selectAllItems(){var t;if(!this.items||!this.interactive||!this.multiselect){return}const e=(((t=this.filteredItems)===null||t===void 0?void 0:t.visible)||this.items).filter((t=>!t.disabled));this.selections=new Set([...this.selections.values(),...e])}deselectItem(t){this.selections.delete(t)}deselectItems(t){if(!this.items){return}this.items.forEach((e=>{if(!t.includes(e)&&e.selected){e.deselect()}}))}deselectAllItems(){var t,e;if(!this.selections||!this.interactive){return}const i=new Set((e=(t=this.filteredItems)===null||t===void 0?void 0:t.visible)!==null&&e!==void 0?e:this.items);const s=[...this.selections].filter((t=>t.disabled||!i.has(t)));this.selections=new Set(s)}syncListInteractiveWithItems(){if(this.items.length>0&&(this.items[0].tagName===n("market-action-card").toUpperCase()||this.items[0].tagName===n("market-row").toUpperCase()&&this.items[0].interactive===true)&&!this.interactive){this.interactive=true}}processItems(){this.items.forEach((t=>{if(t.tagName===n("market-action-card").toUpperCase()){t.transient=this.transient;const e=t.querySelector(n("market-row"));if(e){this.setRowProperties(e)}}else{this.setRowProperties(t)}}))}getCurrentSelectionValues(){if(Array.isArray(this.value)){return new Set(this.value)}return new Set(this.multiselect?this.value.split(","):[this.value])}setRowProperties(t){t.interactive=this.interactive;t.transient=this.transient;t.togglable=this.multiselect}setSelectionsFromValue(){var t;if(this.value||this.value===""){const e=this.getCurrentSelectionValues();(t=this.items)===null||t===void 0?void 0:t.forEach((t=>{if(t===this.controlRow){return}if(!h(this.value)&&e.has(t.value)){t.silentlySelect();this.selectItem(t)}else{t.silentlyDeselect();this.deselectItem(t)}}))}}setSelectionsFromRowAttributes(){const t=new Set;this.items.forEach((e=>{if(e.selected){t.add(e)}}));this.selections=t}setListAndItemsRoles(){const t=this.items.map((t=>c(t)));const e=t.every((t=>t===d.CHECKBOX))||t.every((t=>t===d.RADIO))||t.every((t=>t===d.SWITCH))||t.every((t=>t===d.SELECTABLE_WITHOUT_CONTROL));if(e){this.el.setAttribute("role","listbox");this.items.forEach((t=>{t.setAttribute("role","option")}));this.el.setAttribute("aria-multiselectable",this.multiselect?"true":"false")}else{this.el.setAttribute("role","list");this.items.forEach((t=>{t.setAttribute("role","listitem")}))}if(this.value){this.setSelectionsFromValue()}else{this.setSelectionsFromRowAttributes()}}setInternalState(){this.items=[...this.el.querySelectorAll(`:scope > ${n("market-row")}, :scope > ${n("market-action-card")}`)];if(this.items.length===0){return}this.syncListInteractiveWithItems();this.processItems();this.setListAndItemsRoles();if(this.value){this.setSelectionsFromValue()}else{this.setSelectionsFromRowAttributes()}}async syncControlRowWithSelections(){var t,e;if(!this.controlRow){return}const i=this.controlRow.querySelector('[slot="control"]');const s=i.tagName.toLowerCase()===n("market-checkbox");const r=((e=(t=this.filteredItems)===null||t===void 0?void 0:t.visible)!==null&&e!==void 0?e:this.items).filter((t=>t!==this.controlRow));const a=(()=>{if(r.every((t=>t.selected))){return"checked"}else if(r.some((t=>t.selected))){return"indeterminate"}else{return"unchecked"}})();switch(a){case"unchecked":this.deselectItem(this.controlRow);await this.controlRow.silentlyDeselect();await o();i.removeAttribute("indeterminate");break;case"checked":await this.controlRow.silentlySelect();this.selectItem(this.controlRow);i.removeAttribute("indeterminate");break;case"indeterminate":if(s){await this.controlRow.silentlySelect();this.selectItem(this.controlRow);await o();i.setAttribute("indeterminate","")}else{await this.controlRow.silentlyDeselect();this.deselectItem(this.controlRow)}break}this.injectCountOnControlRow()}injectCountOnControlRow(){if(!this.controlRow){return}const t=this.controlRow.querySelector('.count[slot="trailing-accessory"]');if(this.hideSelectableCount){if(t){this.controlRow.removeChild(t)}return}const e=this.filteredItems.visible.filter((t=>!t.disabled)).length;if(t){t.textContent=`${e}`}else{const t=document.createElement("span");t.classList.add("count");t.setAttribute("slot","trailing-accessory");t.textContent=`${e}`;this.controlRow.appendChild(t)}}filterItems(t){var e;const i=this.items.reduce(((e,i)=>{var s,r,n,o,a,l,h,c,d;if(i.getAttribute("slot")==="control-row"){return e}else if(!t){e.visible.push(i);return e}else if(typeof this.filterStrategy==="function"){const r=this.filterStrategy({item:i,label:(s=i.querySelector('[slot="label"]'))===null||s===void 0?void 0:s.textContent,query:t,textContent:i.textContent,value:i.value});if(r){e.visible.push(i);return e}}else if(((n=(r=this.filterStrategy)===null||r===void 0?void 0:r.toLocaleLowerCase)===null||n===void 0?void 0:n.call(r))==="textcontent"){const s=((o=i===null||i===void 0?void 0:i.textContent)===null||o===void 0?void 0:o.search(new RegExp(t,"i")))>=0;if(s){e.visible.push(i);return e}}else if(((l=(a=this.filterStrategy)===null||a===void 0?void 0:a.toLocaleLowerCase)===null||l===void 0?void 0:l.call(a))==="label"){const s=i.querySelector('[slot="label"]');const r=((h=s===null||s===void 0?void 0:s.textContent)===null||h===void 0?void 0:h.search(new RegExp(t,"i")))>=0;if(r){e.visible.push(i);return e}}else if(((d=(c=this.filterStrategy)===null||c===void 0?void 0:c.toLocaleLowerCase)===null||d===void 0?void 0:d.call(c))==="value"){const s=String(i.value);const r=s.search(new RegExp(t))>=0;if(r){e.visible.push(i);return e}}e.hidden.push(i);return e}),{visible:[],hidden:[],visibleSelected:[],selected:[]});requestAnimationFrame((()=>{var t;i.visible.forEach((t=>t.classList.remove("hidden")));i.hidden.forEach((t=>t.classList.add("hidden")));this.items.forEach((t=>t.classList.remove("hide-bottom-border")));if(i.visible.length>0){const t=i.visible[i.visible.length-1];t.classList.add("hide-bottom-border")}(t=this.controlRow)===null||t===void 0?void 0:t.classList.toggle("hidden",i.visible.length===0)}));if(this.filteredItems||!this.filteredItems&&t){this.marketListItemsFiltered.emit({items:i.visible,prevItems:(e=this.filteredItems)===null||e===void 0?void 0:e.visible})}this.filteredItems=i;this.updateSelectedItemsInFilteredItems()}updateSelectedItemsInFilteredItems(){if(!this.filteredItems){return}this.filteredItems.selected=this.items.filter((t=>t.getAttribute("slot")!=="control-row"&&t.selected));this.filteredItems.visibleSelected=this.filteredItems.visible.filter((t=>t.getAttribute("slot")!=="control-row"&&t.selected))}handleSearchSlotchange(){var t;this.inputSearchEl=this.el.querySelector('[slot="search"]');this.hasSearch=Boolean(this.inputSearchEl);this.filterItems((t=this.inputSearchEl)===null||t===void 0?void 0:t.value)}defaultSlotchangeHandler(){var t;this.setInternalState();this.filterItems((t=this.inputSearchEl)===null||t===void 0?void 0:t.value);this.setReorderable();this.marketListSlotChange.emit()}controlRowSlotchangeHandler(){if(!this.interactive||!this.multiselect){return}const t=this.el.querySelector('[slot="control-row"]');const e=t===null||t===void 0?void 0:t.querySelector('[slot="control"]');this.controlRow=u(e)?t:undefined}setEmptyStateVisibility(){var t,e;const i=this.el.querySelector('[slot="empty-state"]')||this.el.shadowRoot.querySelector(n("market-empty-state"));const s=((t=this.inputSearchEl)===null||t===void 0?void 0:t.value)&&!((e=this.filteredItems)===null||e===void 0?void 0:e.visible.length);i===null||i===void 0?void 0:i.classList.toggle("hidden",!s)}initItemDisabledAttributeObserver(){if(this.observers.itemDisabledAttribute){return}this.observers.itemDisabledAttribute=new MutationObserver((t=>{for(const e of t){if(e.target.parentElement===this.el&&e.type==="attributes"&&e.attributeName==="disabled"){this.injectCountOnControlRow()}}}));this.observers.itemDisabledAttribute.observe(this.el,{attributes:true,attributeFilter:["disabled"],childList:true,subtree:true})}connectedCallback(){this.syncControlRowWithSelections()}componentWillLoad(){var t;this.setInternalState();this.filterItems((t=this.inputSearchEl)===null||t===void 0?void 0:t.value)}componentWillRender(){this.syncListInteractiveWithItems();this.processItems();this.setListAndItemsRoles();this.updateSelectedItemsInFilteredItems();this.controlRowSlotchangeHandler();this.syncControlRowWithSelections();this.setEmptyStateVisibility()}componentDidLoad(){this.initItemDisabledAttributeObserver()}disconnectedCallback(){var t;(t=this.observers.itemDisabledAttribute)===null||t===void 0?void 0:t.disconnect()}handleKeydown(t){switch(t.key){case"ArrowDown":this.handleArrowDown(t);break;case"ArrowUp":this.handleArrowUp(t);break}}handleArrowDown(t){const e=this.el.querySelector(":focus");const i=[...this.items].indexOf(e);if(i===-1){return}for(let t=i+1;t<this.items.length;t++){if(!this.items[t].disabled){this.items[t].focus();break}}t.preventDefault()}handleArrowUp(t){const e=this.el.querySelector(":focus");const i=[...this.items].indexOf(e);if(i===-1){return}for(let t=i-1;t>=0;t--){if(!this.items[t].disabled){this.items[t].focus();break}}t.preventDefault()}async focusRowAtIndex(t){const e=this.items[t];if(e){e.focus();return Promise.resolve()}else{return Promise.reject(new Error(`Row at index ${t} not found`))}}setReorderable(){const{el:t,items:e,controlRow:i,reorderable:s,reorderMode:r,reorder:o,marketListItemsReordered:h}=this;if(s==="off"){o===null||o===void 0?void 0:o.destroy();this.reorder=null}else if(!o){this.reorder=new a({el:t,accepts:[`${n("market-row")}:not([slot="control"])`],event:h,mode:r})}e===null||e===void 0?void 0:e.forEach((t=>{if(!l(t))return;if(t===i)return;t.dragEnabled=s!=="off"}))}onDragMove(t){var e;(e=this.reorder)===null||e===void 0?void 0:e.dragMove(t)}onDragLeave(){var t;(t=this.reorder)===null||t===void 0?void 0:t.dragLeave()}onDragEnd(t){var e;(e=this.reorder)===null||e===void 0?void 0:e.dragEnd(t)}onDragDrop(t){var e;(e=this.reorder)===null||e===void 0?void 0:e.dragDrop(t)}componentDidRender(){this.setReorderable()}render(){var t;const e=n("market-empty-state");return i(s,{key:"f01372045695a9776c6318303fecd322561cdb1d",class:"market-list","aria-labelledby":this.name,"has-search":this.hasSearch,onKeydown:t=>this.handleKeydown(t),onMarketDragMove:t=>this.onDragMove(t),onMarketDragLeave:()=>this.onDragLeave(),onMarketDragEnd:t=>this.onDragEnd(t),onMarketDragDrop:t=>this.onDragDrop(t)},i("slot",{key:"e5a0f3a54f00422e2a116d5958a1d733d4aea540",name:"search",onSlotchange:()=>this.handleSearchSlotchange()}),i("slot",{key:"3aaca12e5456bc8df62bf982d00a997ffdd6a6d8",name:"control-row",onSlotchange:()=>this.controlRowSlotchangeHandler()}),i("slot",{key:"2b528867d3784890f0f54619b302c223eee4cdd5",onSlotchange:()=>this.defaultSlotchangeHandler()}),i("slot",{key:"7d6f8a7cf5a9add9811afe49fe24621260887769",name:"empty-state"},i(e,{key:"af825be4ce90fa63ec83b1f2fda05abb47401750",class:"hidden"},i("svg",{key:"9088bd651dca4d4beaaf6b22e1917af118767e21",height:"40",slot:"media",viewBox:"0 0 40 40",width:"40",xmlns:"http://www.w3.org/2000/svg"},i("path",{key:"795ff6d2afc5584c7b516e60fa385af8964e24be",d:"M34.4667 17.2L28.1 10.8333H26.6667C26.6667 9.45 25.55 8.33333 24.1667 8.33333C22.7834 8.33333 21.6667 9.45 21.6667 10.8333H18.3334C18.3334 9.45 17.2167 8.33333 15.8334 8.33333C14.45 8.33333 13.3334 9.45 13.3334 10.8333H11.9L5.53337 17.2C4.11671 18.6167 3.33337 20.5 3.33337 22.5C3.33337 26.6333 6.70004 30 10.8334 30C14.8 30 18.0167 26.9 18.2834 23.0167C18.8167 23.2167 19.4 23.3333 20 23.3333C20.6 23.3333 21.1834 23.2167 21.7167 23.0167C21.9834 26.9 25.2 30 29.1667 30C33.3 30 36.6667 26.6333 36.6667 22.5C36.6667 20.5 35.8834 18.6167 34.4667 17.2ZM10.8334 26.6667C8.53337 26.6667 6.66671 24.8 6.66671 22.5C6.66671 21.3833 7.10004 20.3333 7.88337 19.55C8.66671 18.7667 9.71671 18.3333 10.8334 18.3333C13.1334 18.3333 15 20.2 15 22.5C15 24.8 13.1334 26.6667 10.8334 26.6667ZM15.35 16.55C14.4667 15.8833 13.4334 15.3833 12.3 15.15L13.2667 14.1667H17.2334C16.3834 14.7333 15.7167 15.5667 15.35 16.55ZM20 20C19.0834 20 18.3334 19.25 18.3334 18.3333C18.3334 17.4167 19.0834 16.6667 20 16.6667C20.9167 16.6667 21.6667 17.4167 21.6667 18.3333C21.6667 19.25 20.9167 20 20 20ZM22.75 14.1667H26.7167L27.7 15.15C26.5667 15.3833 25.5334 15.8833 24.65 16.55C24.2834 15.5667 23.6167 14.7333 22.75 14.1667ZM29.1667 26.6667C26.8667 26.6667 25 24.8 25 22.5C25 20.2 26.8667 18.3333 29.1667 18.3333C30.2834 18.3333 31.3334 18.7667 32.1167 19.55C32.9 20.3333 33.3334 21.3833 33.3334 22.5C33.3334 24.8 31.4667 26.6667 29.1667 26.6667Z",fill:"var(--core-text-10-color)","fill-opacity":"0.9"})),i("h3",{key:"2ed929f1c74989aa9df9809fa509f8c037d05d9b",slot:"primary-text"},i("slot",{key:"eb5ab0008deb0ca384e32a02448f72e836837b2a",name:"empty-state-primary-text"},"No search results for “",(t=this.inputSearchEl)===null||t===void 0?void 0:t.value,"”")),i("p",{key:"d0cb3833586c6b08307cb3529876a44d3668be4c",slot:"secondary-text"},i("slot",{key:"690ffc4bb1f6c81d12ce44aca5aea14d1e8c1bec",name:"empty-state-secondary-text"},"Try a different search.")))))}get el(){return r(this)}static get watchers(){return{reorderable:["reorderableWatcher"],value:["valueWatcher"],hideSelectableCount:["hideSelectableCountWatcher"]}}};st.style=it;export{st as market_list};
//# sourceMappingURL=p-04f2965e.entry.js.map