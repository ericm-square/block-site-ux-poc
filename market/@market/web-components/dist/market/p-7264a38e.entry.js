import{r as t,c as i,h as e,H as s,g as o}from"./p-c9795ae2.js";import{g as n}from"./p-a7d431c5.js";import{a as r}from"./p-e5f35127.js";const a=":host,::slotted(*),*{box-sizing:border-box}:host([disabled]){cursor:not-allowed !important;}:host([disabled]) *,:host([disabled]) ::slotted(*){cursor:not-allowed !important;pointer-events:none !important;}:host{position:fixed;top:0;left:0;z-index:-1000;display:block;overflow:hidden;width:100vw;height:100%;opacity:0%}:host([active]){z-index:1000;opacity:100%;pointer-events:none}";const h=a;const d=class{constructor(e){t(this,e);this.marketContextManagerActivated=i(this,"marketContextManagerActivated",7);this.marketContextManagerDeactivated=i(this,"marketContextManagerDeactivated",7);this.active=false;this.currentContext=undefined;this.stack=[]}initChildListObserver(){if(this.childListObserver)return;const t=()=>{this.stack=[...this.el.children];this.currentContext=this.stack.length>0?this.stack[this.stack.length-1]:null};t();this.childListObserver=new MutationObserver(t);this.childListObserver.observe(this.el,{childList:true})}async getCurrentContext(){while(!this.currentContext){await r()}return this.currentContext}contextEmptiedEventHandler({target:t}){t.remove();this.stack.splice(this.stack.indexOf(t),1);if(this.stack.length===0){this.deactivate()}}windowKeydown(t){var i;if(t.key==="Escape"||t.key==="Esc"){(i=this.currentContext)===null||i===void 0?void 0:i.currentDialog.el.dismiss({origin:this.el})}}async open(t,i){let e=i;if(!this.currentContext||t){e=true}if(e){this.createNewContext()}await this.currentContext.open(t)}close(t){this.currentContext.close(t);return Promise.resolve()}createNewContext(){this.activate();this.el.appendChild(document.createElement(n("market-context")));this.currentContext=this.el.lastElementChild;return Promise.resolve()}deactivate(){this.active=false;this.marketContextManagerDeactivated.emit();return Promise.resolve()}activate(){if(!this.active){this.active=true;this.marketContextManagerActivated.emit()}return Promise.resolve()}handleMouseEvents(t){var i,e;if(t.type==="mousedown"){this.mouseDownEl=t.target.tagName}else if(t.type==="mouseup"){const s=t.target.tagName;if(this.mouseDownEl===s&&t.target.tagName.toLowerCase()===n("market-context")&&!t.target.classList.contains("no-veil")){(e=(i=this.currentContext)===null||i===void 0?void 0:i.currentDialog)===null||e===void 0?void 0:e.el.dismiss({origin:this.el})}}}componentDidLoad(){this.initChildListObserver()}render(){return e(s,{key:"72a7dfd3862281d08036a4d1af846b8203e73893",class:"market-context-manager",onMouseDown:t=>this.handleMouseEvents(t),onMouseUp:t=>this.handleMouseEvents(t)},e("slot",{key:"b7ef4e0031991376e48a559f2a026174667ff429"}))}disconnectedCallback(){var t;(t=this.childListObserver)===null||t===void 0?void 0:t.disconnect()}get el(){return o(this)}};d.style=h;export{d as market_context_manager};
//# sourceMappingURL=p-7264a38e.entry.js.map