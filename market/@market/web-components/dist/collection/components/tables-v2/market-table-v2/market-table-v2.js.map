{"version":3,"file":"market-table-v2.js","sourceRoot":"","sources":["../../../../../src/components/tables-v2/market-table-v2/market-table-v2.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Host, h, Prop, Element, Watch, Listen, Method, Event, EventEmitter } from '@stencil/core';\nimport { getNamespacedTagFor } from '../../../utils/namespace';\nimport {\n  HTMLMarketTableV2ChildElement,\n  TMarketTableV2Selection,\n  MarketTableV2SelectionChangeEventDetail,\n  MarketTableV2SortOrderChangeDetail,\n} from './types';\nimport { Reorderable, TMarketReorderableOptions, TMarketReorderEventDetail } from '../../../utils/reorderable';\nimport { isDraggable, TMarketDragEventDetail } from '../../../utils/draggable';\nimport { sortItems } from './utils';\n\n/**\n * @slot - Default slot for all rows.\n * @part table - The inner table element.\n */\n\n@Component({\n  tag: 'market-table-v2',\n  styleUrl: 'market-table-v2.css',\n  shadow: true,\n})\nexport class MarketTableV2 {\n  private rows: Array<HTMLMarketTableV2RowElement>;\n  private groups: Array<HTMLMarketTableV2GroupElement>;\n  private children: Array<HTMLMarketTableV2ChildElement>;\n  private header: HTMLMarketTableV2RowElement;\n  private footer: HTMLMarketTableV2RowElement;\n  private reorder: Reorderable;\n\n  @Element() el: HTMLMarketTableV2Element;\n\n  /**\n   * Sets the horizontal alignment.\n   * Table alignment will be inherited by descendant rows & cells.\n   */\n  @Prop({ reflect: true }) readonly align: 'left' | 'center' | 'right';\n\n  /**\n   * Whether the slotted table groups are collapsible.\n   */\n  @Prop({ reflect: true }) readonly collapsible: boolean = false;\n\n  /**\n   * Sets the `table-layout` algorithm.\n   * By default, the column widths are adjusted to fit the content.\n   * If column widths are explicitly sized, use `fixed` to speed up render time.\n   * See [table-layout](https://developer.mozilla.org/en-US/docs/Web/CSS/table-layout)\n   * for more information.\n   */\n  @Prop({ reflect: true }) readonly layout: 'auto' | 'fixed' = 'auto';\n\n  /**\n   * Whether the table is reorderable or not.\n   * Setting to `internal` enables reordering table rows internally\n   * while `external` also allows dragging to & from other tables.\n   */\n  @Prop({ reflect: true }) readonly reorderable: TMarketReorderableOptions;\n\n  /**\n   * When set to `framework`, the table will move the reordered item back to its original position\n   * before the `marketTableV2RowsReordered` event is fired. This is useful when the table\n   * is rendered within a framework like Ember or React.\n   */\n  @Prop() readonly reorderMode: 'default' | 'framework' = 'default';\n\n  /**\n   * Whether the table is selected.\n   * Relevant if the table has rows with a slotted controls.\n   */\n  @Prop({ mutable: true }) selected: TMarketTableV2Selection = 'false';\n\n  /**\n   * Sets the vertical alignment.\n   * Table alignment will be inherited by descendant rows & cells.\n   */\n  @Prop({ reflect: true }) readonly valign: 'bottom' | 'middle' | 'top';\n\n  /**\n   * Fired when the table rows are reordered.\n   * If a row was dropped into this table from an external table, `oldIndex` is `-1`.\n   * If a row was removed from this table and dropped into an external table, `newIndex` is `-1`.\n   */\n  @Event({ bubbles: true, composed: true }) marketTableV2RowsReordered: EventEmitter<TMarketReorderEventDetail>;\n\n  @Listen('marketInternalTableV2RowSelectionChange')\n  @Listen('marketInternalTableV2GroupSelectionChange')\n  async onMarketTableV2SelectionChange(e: CustomEvent<MarketTableV2SelectionChangeEventDetail>) {\n    const { header, footer } = this;\n    const { target, detail } = e;\n    const eventSelected = detail.current;\n\n    e.stopPropagation();\n\n    if (target === header || target === footer) {\n      // the target is the header or footer, so propagate values downward\n      await this.setSelected(eventSelected, { silent: true });\n    } else {\n      // the target is a child, and it's complicated...\n      await this.setSelectedFromChildEvent(e);\n    }\n  }\n\n  @Listen('marketTableV2CellSortClicked')\n  onMarketTableV2CellSortClicked(e: CustomEvent<MarketTableV2SortOrderChangeDetail>) {\n    const { el, header, children, groups, footer } = this;\n    const sortedCell = e.target as HTMLMarketTableV2CellElement;\n\n    // only allow sorting from the header row\n    if (sortedCell.parentElement !== header) return;\n\n    const { current: newSortOrder } = e.detail;\n    const headerChildren = [...header.children];\n    const sortedColumnIndex = headerChildren.indexOf(sortedCell);\n    const { sortStrategy, sortStrategyFormat } = sortedCell;\n\n    // sort the children\n    const sortedChildren = sortItems({\n      items: children,\n      order: newSortOrder,\n      column: sortedColumnIndex,\n      strategy: sortStrategy,\n      format: sortStrategyFormat,\n    });\n\n    // sort the groups' children\n    groups?.forEach((group) => {\n      group.sort({\n        order: newSortOrder,\n        column: sortedColumnIndex,\n        strategy: sortStrategy,\n        format: sortStrategyFormat,\n      });\n    });\n\n    // set the header sort values\n    sortedCell.sortOrder = newSortOrder;\n    headerChildren.forEach((cell: HTMLMarketTableV2CellElement) => {\n      cell.sortOrder = cell === sortedCell ? newSortOrder : undefined;\n    });\n\n    // render the sorted rows\n    sortedChildren.forEach((row: HTMLMarketTableV2RowElement) => {\n      el.append(row);\n    });\n    if (footer) el.append(footer);\n  }\n\n  @Listen('marketDragMove')\n  onDragMove(e: CustomEvent<TMarketDragEventDetail>) {\n    this.reorder?.dragMove(e);\n  }\n\n  @Listen('marketDragLeave')\n  onDragLeave() {\n    this.reorder?.dragLeave();\n  }\n\n  @Listen('marketDragEnd')\n  onDragEnd(e: CustomEvent<TMarketDragEventDetail>) {\n    this.reorder?.dragEnd(e);\n  }\n\n  @Listen('marketDragDrop')\n  onDragDrop(e: CustomEvent<TMarketDragEventDetail>) {\n    this.reorder?.dragDrop(e);\n  }\n\n  @Watch('collapsible')\n  watchCollapsible() {\n    const { rows, groups, collapsible } = this;\n\n    groups.forEach((group) => {\n      group.collapsible = collapsible;\n      group.indent = 0;\n    });\n\n    rows.forEach((row) => {\n      // per design, don't indent header or footer rows\n      if (row.header || row.footer) return;\n      // indent rows to line up with groups w/ carets\n      row.indent = collapsible && groups.length > 0 ? 1 : 0;\n    });\n  }\n\n  @Watch('reorderable')\n  watchReorderable() {\n    const { el, reorder, reorderable, reorderMode, marketTableV2RowsReordered } = this;\n\n    reorder?.destroy();\n\n    const reorderEnabled = ['internal', 'external'].includes(reorderable);\n    if (reorderEnabled) {\n      const rowTagName = getNamespacedTagFor('market-table-v2-row');\n      const groupTagName = getNamespacedTagFor('market-table-v2-group');\n\n      this.reorder = new Reorderable({\n        el,\n        accepts: [`${rowTagName}:not([header]):not([footer]):not([slot=\"parent\"])`, groupTagName],\n        event: marketTableV2RowsReordered,\n        mode: reorderMode,\n      });\n    }\n\n    this.syncDragEnabled();\n  }\n\n  /**\n   * @internal\n   * Sets selection on the table and propagates the value\n   * downwards to its children rows and groups.\n   */\n  @Method()\n  async setSelected(selected: TMarketTableV2Selection, { silent = false } = {}) {\n    const { header, footer, children, selected: prevSelected } = this;\n\n    // return if no values have changed\n    if (prevSelected === selected) return Promise.resolve();\n\n    // propagate the new values\n    this.selected = selected;\n    await header?.setSelected(selected, { silent });\n    await footer?.setSelected(selected, { silent });\n    children?.forEach(async (child) => {\n      await child.setSelected(selected, { silent });\n    });\n\n    return Promise.resolve();\n  }\n\n  private async setSelectedFromChildEvent(e: CustomEvent<MarketTableV2SelectionChangeEventDetail>) {\n    const { header, footer, children, selected: prevSelected } = this;\n    const { target, detail } = e;\n    const { current: childSelected } = detail;\n\n    // get an array of what the children's selected values would be AFTER this event\n    const childrenSelected = children.map((child) => {\n      // if the target was THIS child, it will be new event value (not .selected)\n      if (target === child) return childSelected;\n      // otherwise, get the current value directly from this child\n      return child.selected;\n    });\n\n    // what the table's selected value would be AFTER this event\n    const tableSelected = childrenSelected.every((val) => val === 'true')\n      ? 'true'\n      : childrenSelected.every((val) => val === 'false')\n      ? 'false'\n      : 'indeterminate';\n\n    // return if no values have changed\n    if (prevSelected === tableSelected) return;\n\n    // propagate the new value\n    this.selected = tableSelected;\n    await header?.setSelected(tableSelected, { silent: true });\n    await footer?.setSelected(tableSelected, { silent: true });\n  }\n\n  private getElements() {\n    this.rows = [...this.el.children].filter((child) => {\n      return child.tagName === getNamespacedTagFor('market-table-v2-row').toUpperCase();\n    }) as Array<HTMLMarketTableV2RowElement>;\n\n    this.groups = [...this.el.children].filter((child) => {\n      return child.tagName === getNamespacedTagFor('market-table-v2-group').toUpperCase();\n    }) as Array<HTMLMarketTableV2GroupElement>;\n\n    this.header = this.rows.find((row) => row.header);\n    this.footer = this.rows.find((row) => row.footer);\n    this.children = [...this.groups, ...this.rows.filter((row) => !row.header && !row.footer)];\n  }\n\n  private syncDragEnabled() {\n    const { header, footer, rows, groups, reorderable, reorderMode } = this;\n\n    const reorderEnabled = ['internal', 'external'].includes(reorderable);\n\n    if (header) header.dragEnabled = reorderEnabled;\n    if (footer) footer.dragEnabled = reorderEnabled;\n\n    rows?.forEach((row) => {\n      if (!isDraggable(row)) return;\n      row.dragEnabled = reorderEnabled;\n    });\n\n    groups?.forEach((group) => {\n      group.dragEnabled = reorderEnabled;\n      group.reorderable = reorderable;\n      group.reorderMode = reorderMode;\n    });\n  }\n\n  private onSlotChange() {\n    this.getElements();\n    this.watchCollapsible();\n    this.syncDragEnabled();\n  }\n\n  connectedCallback() {\n    this.getElements();\n    this.watchCollapsible();\n    this.syncDragEnabled();\n  }\n\n  componentDidRender() {\n    this.watchReorderable();\n  }\n\n  render() {\n    return (\n      <Host class=\"market-table-v2\">\n        <div role=\"table\" part=\"table\">\n          <slot onSlotchange={() => this.onSlotChange()}></slot>\n        </div>\n      </Host>\n    );\n  }\n}\n"]}