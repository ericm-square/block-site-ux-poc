{"version":3,"file":"market-drag-handle.e2e.js","sourceRoot":"","sources":["../../../../../src/components/market-drag-handle/test/market-drag-handle.e2e.ts"],"names":[],"mappings":"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","sourcesContent":["import { newE2EPage, E2EPage, E2EElement, EventSpy } from '@stencil/core/testing';\n\ndescribe('market-drag-handle', () => {\n  let page: E2EPage;\n  let el: E2EElement;\n  let marketDragHandleDragStartSpy: EventSpy;\n  let marketDragHandleDragMoveSpy: EventSpy;\n  let marketDragHandleDragEndSpy: EventSpy;\n\n  beforeEach(async () => {\n    page = await newE2EPage();\n\n    // position absolute top left to simplify mouse manipulation\n    await page.setContent(`\n      <market-drag-handle style=\"position: absolute; left: 0; top: 0\"></market-drag-handle>\n    `);\n\n    el = await page.find('market-drag-handle');\n    marketDragHandleDragStartSpy = await el.spyOnEvent('marketDragHandleDragStart');\n    marketDragHandleDragMoveSpy = await el.spyOnEvent('marketDragHandleDragMove');\n    marketDragHandleDragEndSpy = await el.spyOnEvent('marketDragHandleDragEnd');\n  });\n\n  it('renders', () => {\n    expect(el).toHaveAttribute('hydrated');\n  });\n\n  describe('mouse events', () => {\n    describe('on mousedown', () => {\n      beforeEach(async () => {\n        await page.mouse.move(1, 1);\n        await page.mouse.down();\n        await page.waitForChanges();\n      });\n\n      it('fires drag start event', () => {\n        expect(marketDragHandleDragStartSpy).toHaveReceivedEventTimes(1);\n        expect(marketDragHandleDragStartSpy).toHaveReceivedEventDetail({ x: 1, y: 1 });\n      });\n\n      it('does not fire the other drag events yet', () => {\n        expect(marketDragHandleDragMoveSpy).not.toHaveReceivedEvent();\n        expect(marketDragHandleDragEndSpy).not.toHaveReceivedEvent();\n      });\n\n      describe('on mousemove', () => {\n        beforeEach(async () => {\n          await page.mouse.move(2, 2);\n          await page.waitForChanges();\n        });\n\n        it('fires drag move event', () => {\n          expect(marketDragHandleDragMoveSpy).toHaveReceivedEventTimes(1);\n          expect(marketDragHandleDragMoveSpy).toHaveReceivedEventDetail({ x: 2, y: 2 });\n        });\n\n        it('does not fire the drag end event yet', () => {\n          expect(marketDragHandleDragEndSpy).not.toHaveReceivedEvent();\n        });\n\n        describe('on mouseup', () => {\n          beforeEach(async () => {\n            await page.mouse.up();\n            await page.waitForChanges();\n          });\n\n          it('fires drag end event', () => {\n            expect(marketDragHandleDragEndSpy).toHaveReceivedEventTimes(1);\n            expect(marketDragHandleDragEndSpy).toHaveReceivedEventDetail({ x: 2, y: 2 });\n          });\n        });\n      });\n    });\n\n    describe('when right mouse button is used', () => {\n      beforeEach(async () => {\n        await page.mouse.move(1, 1);\n        await page.mouse.down({ button: 'right' });\n        await page.mouse.move(2, 2);\n        await page.mouse.up({ button: 'right' });\n        await page.waitForChanges();\n      });\n\n      it('does not fire any drag events', () => {\n        expect(marketDragHandleDragStartSpy).not.toHaveReceivedEvent();\n        expect(marketDragHandleDragMoveSpy).not.toHaveReceivedEvent();\n        expect(marketDragHandleDragEndSpy).not.toHaveReceivedEvent();\n      });\n    });\n\n    describe('when e.preventDefault() is called on a drag start', () => {\n      beforeEach(async () => {\n        await page.$eval('market-drag-handle', (el: HTMLMarketDragHandleElement) => {\n          el.addEventListener('marketDragHandleDragStart', (e: CustomEvent) => {\n            e.preventDefault();\n          });\n        });\n        await page.mouse.move(1, 1);\n        await page.mouse.down();\n        await page.mouse.move(2, 2);\n        await page.mouse.up();\n        await page.waitForChanges();\n      });\n\n      it('only fires drag start and no other events', () => {\n        expect(marketDragHandleDragStartSpy).toHaveReceivedEventTimes(1);\n        expect(marketDragHandleDragMoveSpy).not.toHaveReceivedEvent();\n        expect(marketDragHandleDragEndSpy).not.toHaveReceivedEvent();\n      });\n    });\n  });\n\n  describe('touch events', () => {\n    it('fires drag start and end events on tap', async () => {\n      // couldn't find any utilities for touch events in this version of puppeteer :(\n      // best we have is el.tap() so we can't completely test touch support here. boo!\n      await el.tap();\n\n      expect(marketDragHandleDragStartSpy).toHaveReceivedEventTimes(1);\n      expect(marketDragHandleDragMoveSpy).not.toHaveReceivedEvent();\n      expect(marketDragHandleDragEndSpy).toHaveReceivedEventTimes(1);\n    });\n  });\n});\n"]}