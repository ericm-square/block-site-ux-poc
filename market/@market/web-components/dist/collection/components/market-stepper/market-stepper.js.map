{"version":3,"file":"market-stepper.js","sourceRoot":"","sources":["../../../../src/components/market-stepper/market-stepper.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Host, h, Element, Prop, State, Method, Watch, Event, EventEmitter } from '@stencil/core';\n\nimport { submitFormImplicitly } from '../../utils/forms';\n\n/**\n * @part native-input - the native input element.\n */\n@Component({\n  tag: 'market-stepper',\n  styleUrl: 'market-stepper.css',\n  shadow: true,\n})\nexport class MarketStepper {\n  @Element() el: HTMLMarketStepperElement;\n\n  inputEl: HTMLInputElement;\n\n  /**\n   * The value for the input. This is visually shown on the input\n   * and can be edited by the user.\n   */\n  @Prop({ mutable: true, reflect: true }) value: number;\n\n  /**\n   * The ID for the inner input.\n   */\n  @Prop() readonly inputId: string;\n\n  /**\n   * The name for the inner input.\n   */\n  @Prop() readonly name: string;\n\n  /**\n   * The placeholder of the input. Shown before a user attempts to\n   * add a value, given no value is already provided.\n   */\n  @Prop() readonly placeholder: string = '0';\n\n  /**\n   * A number specifying the greatest value in the range of permitted values.\n   * (See MDN on the [max attribute](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#max))\n   */\n  @Prop() readonly max: number;\n\n  /**\n   * A number specifying the most negative value in the range of permitted values.\n   * (See MDN on the [min attribute](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#min))\n   */\n  @Prop() readonly min: number;\n\n  /**\n   * A positive number specifying the increment step.\n   * (See MDN on the [step attribute](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#step))\n   */\n  @Prop() readonly step: number = 1;\n\n  /**\n   * Whether the input is readonly or not.\n   */\n  @Prop({ reflect: true }) readonly readonly: boolean = false;\n\n  /**\n   * Whether the input is disabled or not.\n   * This visually and functionally disables the input.\n   */\n  @Prop({ reflect: true }) readonly disabled: boolean = false;\n\n  /**\n   * Whether the input is focused or not.\n   */\n  @Prop({ mutable: true, reflect: true }) focused: boolean = false;\n\n  /**\n   * Whether the input is invalid or not. This represents error states.\n   */\n  @Prop({ reflect: true }) readonly invalid: boolean = false;\n\n  /**\n   * The inner input's aria-label. Localize as needed.\n   */\n  @Prop({ reflect: true }) readonly inputAriaLabel: string = 'Number';\n\n  /**\n   * The decrement button's aria-label. Localize as needed.\n   */\n  @Prop({ reflect: true }) readonly decrementAriaLabel: string = 'Decrement';\n\n  /**\n   * The increment button's aria-label. Localize as needed.\n   */\n  @Prop({ reflect: true }) readonly incrementAriaLabel: string = 'Increment';\n\n  @State() incrementDisabled: boolean = false;\n  @State() decrementDisabled: boolean = false;\n\n  /**\n   * Emitted when the value changes.\n   */\n  @Event() marketStepperValueChange: EventEmitter;\n\n  /**\n   * Emitted when the inner `<input>` element is focused.\n   */\n  @Event() marketStepperInputFocus: EventEmitter;\n\n  @Watch('value')\n  valueChangeHandler() {\n    // sanitize value in case it was set programmatically\n    const sanitized = this.sanitizeValue(this.value);\n    if (sanitized !== this.value) {\n      this.value = sanitized;\n    }\n    this.updateButtonDisabledStates();\n  }\n\n  /**\n   * Toggle focus styling on `<market-stepper>` and focus/blur the inner `<input />`.\n   */\n  @Method()\n  setFocus(value: boolean = true) {\n    if (this.readonly || this.disabled) {\n      return Promise.resolve();\n    }\n    this.focused = value;\n    this.focused ? this.inputEl.focus() : this.inputEl.blur();\n    return Promise.resolve();\n  }\n\n  onChange(): void {\n    const previousValue = this.value;\n    let nextValue = Number.parseFloat(this.inputEl.value);\n\n    if (Number.isNaN(nextValue)) {\n      // not a valid number, so reset it to null/empty\n      nextValue = null;\n      this.inputEl.value = '';\n    } else {\n      // a valid number, so sanitize it against min/max/step props\n      nextValue = this.sanitizeValue(nextValue);\n      this.inputEl.value = nextValue.toString();\n    }\n\n    // if value has changed, set it and emit event\n    if (nextValue !== previousValue) {\n      this.value = nextValue;\n      this.emitChangeEvent(previousValue);\n    }\n  }\n\n  onInputFocus(): void {\n    this.emitInputFocusEvent();\n  }\n\n  onDecrementClick(): void {\n    this.stepValue(-this.step);\n  }\n\n  onIncrementClick(): void {\n    this.stepValue(this.step);\n  }\n\n  onKeyDown(e: KeyboardEvent) {\n    if (e.key === 'Enter') {\n      submitFormImplicitly(this.el);\n    }\n  }\n\n  stepValue(step: number): void {\n    const previousValue = this.value;\n    const nextValue = (previousValue || 0) + step;\n    const sanitizedValue = this.sanitizeValue(nextValue);\n    if (sanitizedValue !== previousValue) {\n      this.value = sanitizedValue;\n      this.emitChangeEvent(previousValue);\n    }\n  }\n\n  sanitizeValue(value: number): number {\n    const decimalPlaces = this.step.toString().split('.')[1]?.length || 0;\n    const hasMax = this.max !== null && this.max !== undefined;\n    const hasMin = this.min !== null && this.min !== undefined;\n\n    // round value to the nearest step\n    let sanitized = Math.round(value / this.step) * this.step;\n    // correct any floating point math errors\n    sanitized = Number.parseFloat(sanitized.toFixed(decimalPlaces));\n    // limit value to max\n    sanitized = hasMax ? Math.min(sanitized, this.max) : sanitized;\n    // limit value to min\n    return hasMin ? Math.max(sanitized, this.min) : sanitized;\n  }\n\n  updateButtonDisabledStates() {\n    const { value, max, min } = this;\n    const hasValue = value !== null && value !== undefined;\n    this.incrementDisabled = hasValue ? value === max : false;\n    this.decrementDisabled = hasValue ? value === min : false;\n  }\n\n  emitChangeEvent(previousValue) {\n    const { el, value, marketStepperValueChange } = this;\n    marketStepperValueChange.emit({ el, value, previousValue });\n  }\n\n  emitInputFocusEvent() {\n    const { marketStepperInputFocus } = this;\n    marketStepperInputFocus.emit();\n  }\n\n  componentWillRender() {\n    this.updateButtonDisabledStates();\n  }\n\n  render() {\n    return (\n      <Host\n        class=\"market-stepper\"\n        onFocus={() => {\n          this.focused = true;\n        }}\n        onBlur={() => {\n          this.focused = false;\n        }}\n      >\n        <button\n          tabindex={this.disabled || this.decrementDisabled ? -1 : null}\n          disabled={this.disabled || this.decrementDisabled}\n          onClick={() => this.onDecrementClick()}\n          aria-label={this.decrementAriaLabel}\n        >\n          <svg width=\"10\" height=\"2\" viewBox=\"0 0 10 2\" xmlns=\"http://www.w3.org/2000/svg\">\n            <path d=\"M9.66667 0.333328H0.333336V1.66666H9.66667V0.333328Z\" />\n          </svg>\n        </button>\n        <input\n          ref={(el) => (this.inputEl = el)}\n          type=\"number\"\n          id={this.inputId}\n          name={this.name}\n          readonly={this.readonly}\n          disabled={this.disabled}\n          placeholder={this.placeholder}\n          step={this.step}\n          min={this.min}\n          max={this.max}\n          value={this.value}\n          aria-label={this.inputAriaLabel}\n          onChange={() => this.onChange()}\n          onFocus={() => this.onInputFocus()}\n          onKeyDown={(e) => this.onKeyDown(e)}\n          part=\"native-input\"\n        />\n        <button\n          tabindex={this.disabled || this.incrementDisabled ? -1 : null}\n          disabled={this.disabled || this.incrementDisabled}\n          onClick={() => this.onIncrementClick()}\n          aria-label={this.incrementAriaLabel}\n        >\n          <svg width=\"10\" height=\"10\" viewBox=\"0 0 10 10\" xmlns=\"http://www.w3.org/2000/svg\">\n            <path d=\"M5.66665 9.66666V5.66666H9.66665V4.33333H5.66665V0.333328H4.33331V4.33333H0.333313V5.66666H4.33331V9.66666H5.66665Z\" />\n          </svg>\n        </button>\n      </Host>\n    );\n  }\n}\n"]}