{"version":3,"file":"market-textarea.js","sourceRoot":"","sources":["../../../../src/components/market-textarea/market-textarea.tsx"],"names":[],"mappings":"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","sourcesContent":["import { TEXTAREA_MAXIMUM_HEIGHT } from '@market/market-theme/js/cjs/index.js';\nimport { Component, Host, h, Element, Prop, Event, EventEmitter, Listen, State, Method } from '@stencil/core';\n\nimport { getTextInputAriaLabel, observeAriaAttributes, AriaAttributes } from '../../utils/aria';\n\n/**\n * @slot - The main label for the textarea.\n * @slot textarea - Can be used to slot your own custom textarea element.\n * @part container - The containing div for the textarea and label.\n */\n@Component({\n  tag: 'market-textarea',\n  styleUrl: 'market-textarea.css',\n  shadow: true,\n})\nexport class MarketTextarea {\n  private slottedTextarea?: HTMLTextAreaElement;\n\n  @Element() el: HTMLMarketTextareaElement;\n\n  /**\n   * A string specifying the placeholder of the textarea.\n   * This is shown before a user attempts to add a value, given no value is already provided.\n   */\n  @Prop() readonly placeholder: string;\n\n  /**\n   * A string specifying a name for the textarea.\n   */\n  @Prop() readonly name: string;\n\n  /**\n   * A string specifying a value for the textarea. This will be visually shown on the textarea and can be edited by the user.\n   */\n  @Prop({ mutable: true, reflect: true }) value: string = '';\n\n  /**\n   * A string specifying the maximum length of characters for the input value.\n   */\n  @Prop() readonly maxlength: string;\n\n  /**\n   * A boolean representing whether the textarea is readonly or not.\n   */\n  @Prop({ reflect: true }) readonly readonly: boolean = false;\n\n  /**\n   * A boolean representing whether the textarea is disabled or not.\n   * This visually and functionally will disable the textarea.\n   */\n  @Prop({ reflect: true }) readonly disabled: boolean = false;\n\n  /**\n   * A boolean representing whether the textarea is focused or not.\n   */\n  @Prop({ mutable: true, reflect: true }) focused: boolean = false;\n\n  /**\n   * A boolean representing whether the textarea is invalid or not.\n   * This represents error states.\n   */\n  @Prop({ reflect: true }) readonly invalid: boolean = false;\n\n  /**\n   * A string specifying the maximum height in pixels for the textarea. Vertical resizing will be limited to this height. Example value: '200px'.\n   *\n   * **DEPRECATED**: set `max-height` via CSS\n   *\n   * @default '320px'\n   */\n  @Prop() readonly maxHeight: string = `${TEXTAREA_MAXIMUM_HEIGHT}px`;\n\n  /**\n   * A boolean representing whether the input should focus on page load.\n   * If multiple elements with `autofocus` are present, it is not guaranteed which one\n   * will ultimately receive the focus. It is advised that only one at most is present.\n   */\n  @Prop() readonly autofocus: boolean = false;\n\n  /**\n   * Allows a browser to display an appropriate virtual keyboard.\n   * [Accepted values](https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/inputmode).\n   */\n  @Prop() readonly inputmode: string;\n\n  /**\n   * Fired whenever the value of the textarea changes.\n   */\n  @Event() marketTextareaValueChange: EventEmitter<{ value: string; originalEvent: KeyboardEvent }>;\n\n  @State() ariaAttributes: AriaAttributes;\n\n  mutationObserver: MutationObserver;\n\n  sharedProps: {};\n\n  @Listen('marketDialogLoaded', { target: 'window' })\n  handleMarketDialogLoaded() {\n    if (this.autofocus) {\n      this.setFocus();\n    }\n  }\n\n  /**\n   * Allows passing an alternative light DOM textarea.\n   * Sets the this.slottedTextarea value to undefined if there is no slotted element.\n   */\n  @Method()\n  registerSlottedTextarea(slottedTextarea?: HTMLTextAreaElement) {\n    this.slottedTextarea =\n      slottedTextarea ||\n      // textarea slotted into market-textarea\n      this.el.querySelector('textarea[slot=textarea]') ||\n      // textarea slotted into a higher-level component that uses market-textarea\n      (this.el.getRootNode() as ShadowRoot).host?.querySelector('textarea[slot=textarea]');\n    if (this.slottedTextarea) {\n      this.slottedTextarea.addEventListener('input', (e) => this.textareaValueDidChange(e));\n      this.slottedTextarea.addEventListener('focus', () => this.setFocus());\n      this.slottedTextarea.addEventListener('blur', () => (this.focused = false));\n    }\n\n    return Promise.resolve();\n  }\n\n  syncSharedPropsToSlottedTextarea(prevSharedProps) {\n    // sync component props to slotted input, if one exists\n    if (this.slottedTextarea) {\n      const modifiedPropKeys = [...new Set([...Object.keys(prevSharedProps), ...Object.keys(this.sharedProps)])];\n      modifiedPropKeys.forEach((key) => {\n        if (!(key in this.sharedProps)) {\n          // remove properties that have been unset\n          this.slottedTextarea.removeAttribute(key);\n        } else {\n          // boolean attributes can be set using empty strings\n          // https://developer.mozilla.org/en-US/docs/Web/API/Element/setAttribute#javascript\n          const attributeValue = this.sharedProps[key] !== true ? this.sharedProps[key] : '';\n          this.slottedTextarea.setAttribute(key, attributeValue);\n        }\n      });\n    }\n  }\n\n  updateSharedPropsAndSyncSlottedTextarea() {\n    const prevSharedProps = { ...this.sharedProps };\n\n    // used by the default shadow DOM native input and to copy component properties to slotted inputs\n    // conditionally adding key/value pairs based on whether we want to set them on the <input>\n    // https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input#individual_attributes\n    this.sharedProps = {\n      ...(this.name && { name: this.name }),\n      ...(this.placeholder && { placeholder: this.placeholder }),\n      ...(this.maxlength !== undefined && Number.parseInt(this.maxlength, 10) >= 0 && { maxlength: this.maxlength }),\n      ...(this.value !== undefined && { value: this.value }),\n      ...(this.readonly && { readonly: this.readonly }),\n      ...(this.disabled && { disabled: this.disabled }),\n      ...(this.autofocus && { autofocus: this.autofocus }),\n      ...(this.inputmode && { inputmode: this.inputmode }),\n      ...this.ariaAttributes,\n      'aria-label': getTextInputAriaLabel(this.el),\n    };\n\n    this.syncSharedPropsToSlottedTextarea(prevSharedProps);\n  }\n\n  onMutationObserved = (ariaAttributes: AriaAttributes) => {\n    this.ariaAttributes = ariaAttributes;\n  };\n\n  componentWillLoad() {\n    this.mutationObserver = observeAriaAttributes(this.el, this.onMutationObserved);\n    this.registerSlottedTextarea();\n    this.updateSharedPropsAndSyncSlottedTextarea();\n  }\n\n  componentDidLoad() {\n    if (this.maxHeight) {\n      // Set the passed max height on the input container, since that's where\n      // the drag handle will actually be visible.\n      // This will be removed until `maxHeight` prop is fully deprecated.\n      this.el.style.maxHeight = this.maxHeight;\n    }\n  }\n\n  componentWillUpdate() {\n    this.updateSharedPropsAndSyncSlottedTextarea();\n  }\n\n  textareaValueDidChange(e) {\n    // Need to update value for the label, which floats if this value exists.\n    this.value = e.target.value;\n\n    this.marketTextareaValueChange.emit({\n      value: e.target.value,\n      originalEvent: e,\n    });\n  }\n\n  setFocus(value: boolean = true) {\n    if (this.readonly || this.disabled) {\n      return;\n    }\n\n    const shouldSetElementFocus = value && !this.focused;\n\n    this.focused = value;\n\n    // Set focus on element if not already focused\n    if (shouldSetElementFocus) {\n      this.slottedTextarea ? this.slottedTextarea.focus() : this.el?.shadowRoot?.querySelector?.('textarea')?.focus?.();\n    }\n  }\n\n  render() {\n    return (\n      <Host\n        class=\"market-textarea\"\n        onBlur={() => {\n          this.focused = false;\n        }}\n        onClick={() => {\n          this.setFocus();\n        }}\n        onFocus={() => {\n          this.setFocus();\n        }}\n      >\n        <div class=\"label-input-container\" part=\"container\">\n          <slot></slot>\n          <slot name=\"textarea\" onSlotchange={() => this.registerSlottedTextarea()}>\n            {!this.slottedTextarea && (\n              <textarea\n                {...this.ariaAttributes}\n                id={this.name}\n                onInput={(e) => this.textareaValueDidChange(e)}\n                {...this.sharedProps}\n              ></textarea>\n            )}\n          </slot>\n        </div>\n      </Host>\n    );\n  }\n\n  disconnectedCallback() {\n    this.mutationObserver?.disconnect();\n  }\n}\n"]}