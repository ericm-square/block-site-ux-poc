{"file":"market-icon.entry.js","mappings":"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","names":[],"sources":["src/utils/icons.ts","src/components/market-icon/market-icon.css?tag=market-icon&encapsulation=shadow","src/components/market-icon/market-icon.tsx"],"sourcesContent":["export function getDefaultIconFidelity(icon): number {\n  const defaultFidelity = Object.keys(icon)\n    .filter((key) => key.includes('fidelity'))\n    .find((fidelity) => {\n      return icon[fidelity].default ? icon[fidelity].size : null;\n    });\n\n  return icon[defaultFidelity].size;\n}\n\nexport function getFidelityToken(fidelity: number, icon) {\n  return icon[`fidelity:${fidelity}`];\n}\n\nexport function isValidTokenFidelity(fidelity: number, icon): boolean {\n  return Boolean(getFidelityToken(fidelity, icon));\n}\n\nexport function getMarketIconSVGSymbol(asset: string, fidelity?: number): HTMLElement {\n  // Return the SVG asset matching the asset name and the fidelity provided. Of no fidelity provided, return the first match.\n  return fidelity\n    ? document.querySelector(`[data-name=\"${asset}\"][data-fidelity=\"${fidelity}\"]`)\n    : document.querySelector(`[data-name=\"${asset}\"]`);\n}\n\nexport function isValidSpriteFidelity(asset: string, fidelity: number): boolean {\n  return Boolean(getMarketIconSVGSymbol(asset, fidelity));\n}\n","@property --icon-width {\n  syntax: \"<length>\";\n  inherits: false;\n  initial-value: 24px;\n}\n\n@property --icon-height {\n  syntax: \"<length>\";\n  inherits: false;\n  initial-value: 24px;\n}\n\n:host {\n  display: inline-block;\n  width: var(--icon-width);\n  height: var(--icon-height);\n  color: inherit;\n}\n\n:host([tintable]) {\n  ::slotted(svg) {\n    fill: currentcolor;\n\n    path,\n    circle,\n    rect,\n    polygon,\n    ellipse,\n    line,\n    polyline {\n      fill: inherit;\n    }\n  }\n}\n\n::slotted(svg) {\n  display: block;\n  width: 100%;\n  height: 100%;\n}\n","import { Component, Element, Host, Prop, h } from '@stencil/core';\nimport tokens from '@market/market-theme/js/icons.json';\nimport marketSVGSprite from '@market/market-theme/assets/icons/icons.svg';\nimport {\n  getDefaultIconFidelity,\n  getFidelityToken,\n  isValidTokenFidelity,\n  isValidSpriteFidelity,\n  getMarketIconSVGSymbol,\n} from '../../utils/icons';\n\nconst marketIconSVGSpriteID = '#market-icon-sprite';\n\n@Component({\n  tag: 'market-icon',\n  styleUrl: 'market-icon.css',\n  shadow: true,\n})\nexport class MarketIcon {\n  @Element() el: HTMLMarketIconElement;\n\n  /**\n   * A string identifier for the icon. This can be either the semantic name which maps to\n   * a token or the descriptive name, which maps to a SVG id in the sprite, though using the\n   * semantic name is preferred because it gives you access to additional features like fidelity.\n   * You can also pass any string and it will display a symbol or group within any SVG sprite\n   * on the page, whether it is the Market sprite or not.\n   */\n  @Prop({ reflect: true, mutable: false }) readonly name: string;\n\n  /**\n   * Optional: A number representing the fidelity of the icon to display.\n   */\n  @Prop({ reflect: true, mutable: false }) readonly fidelity: number;\n\n  /**\n   * Whether or not the icon can change color (is monotone).\n   * */\n  tintable: boolean = true;\n\n  width: number;\n  height: number;\n\n  cloneSymbol(symbol, assetName, width, height) {\n    // Remove any existing SVG child elements so we don't duplicate them\n    this.el.querySelectorAll('svg').forEach((svg) => svg.remove());\n\n    const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n    svg.setAttributeNS('http://www.w3.org/2000/xmlns/', 'xmlns:xlink', 'http://www.w3.org/1999/xlink');\n    svg.dataset.name = assetName;\n    svg.setAttribute('viewBox', symbol?.getAttribute('viewBox'));\n    width && svg.setAttribute('width', `${width}`);\n    height && svg.setAttribute('height', `${height}`);\n    svg.innerHTML = symbol.innerHTML;\n\n    this.el.appendChild(svg);\n  }\n\n  getDimensions(symbol, fidelityToken, currentFidelity) {\n    // Get the dimensions from the symbol's viewBox attribute\n    const dimensions =\n      symbol\n        ?.getAttribute('viewBox')\n        .split(/\\s/)\n        .map((d) => Number.parseInt(d, 10)) || [];\n\n    /* Set the dimensions based on the following:\n    1. Passed width/height param\n    2. Width & Height as read from the tokens\n    3. The numbers from the matching SVG symbol's viewBox attribute\n    4. Whatever the currentFidelity is set to (assumes square dimensions)\n    */\n    const width = fidelityToken?.width ?? dimensions[2] ?? currentFidelity;\n    const height = fidelityToken?.height ?? dimensions[3] ?? currentFidelity;\n    return { width, height };\n  }\n\n  componentWillLoad() {\n    let assetName, currentFidelity, defaultFidelity, fidelityToken, symbol;\n\n    // Find the market SVG sprite if it is on the page\n    const documentSVGSprite = document.querySelector(marketIconSVGSpriteID) as SVGElement;\n\n    /* If we can't find a symbol or a root level SVG sprite, that means we need to add the default one\n    to the page */\n    if (!documentSVGSprite) {\n      /* This feels sort of icky, but using innerHTML apparently the best way to convert the string\n      that gets loaded from importing marketSVGSprite into an actual DOM element */\n      const template = document.createElement('div');\n      template.innerHTML = marketSVGSprite;\n      const sprite = template.querySelector(marketIconSVGSpriteID) as SVGElement;\n      sprite.style.display = 'none';\n      document.body.append(sprite);\n      template.remove();\n    }\n\n    // Get the full icon object as well as the object at the correct fidelity key if passed.\n    const iconToken = tokens.core.icon[this.name];\n\n    // If we have passed a semantic name\n    if (iconToken) {\n      // Determine the default fidelity from the tokens.\n      defaultFidelity = getDefaultIconFidelity(iconToken);\n      // Current fidelity is either the fidelity that is passed if it is valid, or the default fidelity\n      currentFidelity = isValidTokenFidelity(this.fidelity, iconToken) ? this.fidelity : defaultFidelity;\n      // Get the JSON object of the token values for this icon for this icon\n      fidelityToken = getFidelityToken(currentFidelity, iconToken);\n\n      // Find the asset name for this semantic icon\n      assetName = fidelityToken?.asset;\n\n      // Otherwise we've passed a descriptive name\n    } else {\n      // The name passed is assumed to be the asset name\n      assetName = this.name;\n\n      // If fidelity here is null or invalid, then this will be an approximate selection of the symbol\n      // But we need to surmise some default fidelity and current fidelity from something and since we\n      // dont have tokens, the SVG markup is the only thing we have more or less.\n      symbol = getMarketIconSVGSymbol(assetName, this.fidelity);\n\n      // Approximate a default fidelity from the matching SVG symbol in the sprite\n      defaultFidelity = Number.parseInt(symbol?.dataset.fidelity, 10);\n\n      // Current fidelity is either the fidelity that is passed if it is valid, or the default fidelity\n      currentFidelity = isValidSpriteFidelity(assetName, this.fidelity) ? this.fidelity : defaultFidelity;\n    }\n\n    /* Even if we already have a symbol, we want to run this function again in case the symbol\n    assignment on line 120 was assigned based on a non-existent or invalid fidelity */\n    symbol = getMarketIconSVGSymbol(assetName, currentFidelity);\n\n    const { width, height } = this.getDimensions(symbol, fidelityToken, currentFidelity);\n\n    if (symbol) {\n      // Append the symbol to the component's template\n      this.cloneSymbol(symbol, assetName, width, height);\n    }\n\n    // set props needed for render\n    this.width = width;\n    this.height = height;\n    this.tintable = fidelityToken?.tintable ?? true;\n  }\n\n  render() {\n    return (\n      <Host\n        class=\"market-icon\"\n        tintable={this.tintable}\n        style={{\n          '--icon-width': `${this.width}px`,\n          '--icon-height': `${this.height}px`,\n        }}\n      >\n        <slot></slot>\n      </Host>\n    );\n  }\n}\n"],"version":3}